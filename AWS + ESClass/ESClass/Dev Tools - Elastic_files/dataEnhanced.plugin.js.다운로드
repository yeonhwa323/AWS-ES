/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,a,o=t[0],r=t[1],i=0,u=[];i<o.length;i++)a=o[i],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&u.push(s[a][0]),s[a]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(c&&c(t);u.length;)u.shift()()}var n={},s={0:0};function a(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.e=function(e){var t=[],n=s[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,a){n=s[e]=[t,a]}));t.push(n[2]=o);var r,i=document.createElement("script");i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.src=function(e){return a.p+"dataEnhanced.chunk."+e+".js"}(e);var c=new Error;r=function(t){i.onerror=i.onload=null,clearTimeout(u);var n=s[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",c.name="ChunkLoadError",c.type=a,c.request=o,n[1](c)}s[e]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:i})}),12e4);i.onerror=i.onload=r,document.head.appendChild(i)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var o=window.dataEnhanced_bundle_jsonpfunction=window.dataEnhanced_bundle_jsonpfunction||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var i=0;i<o.length;i++)t(o[i]);var c=r;a(a.s=18)}([function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){n.r(t);var s=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){n.r(t);var s=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},function(e,t,n){e.exports=n(14)(1075)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),a=n(0),o=s.__importDefault(n(20));t.default=function(e,t){var n=a.useState(t),s=n[0],r=n[1];return o.default((function(){var t=e.subscribe(r);return function(){return t.unsubscribe()}}),[e]),s}},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,n){n.r(t);var s=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,n){e.exports=n(14)(1076)},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var s=n(5),a=n(1);const o={id:a.SEARCH_SESSIONS_MANAGEMENT_ID,getI18nName:()=>s.i18n.translate("xpack.data.mgmt.searchSessions.appTitle",{defaultMessage:"Search Sessions"})};function r(e,t,s,a){a.management.sections.section.kibana.registerApp({id:o.id,title:o.getI18nName(),order:1.75,mount:async o=>{const{SearchSessionsMgmtApp:r}=await n.e(1).then(n.bind(null,24));return new r(e,t,s,o,a).mountManagementSection()}})}},function(e,t,n){n.r(t);var s=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,n){n(19),__kbnBundles__.define("plugin/dataEnhanced/public",n,21)},function(e,t,n){n.p=window.__kbnPublicPath__.dataEnhanced},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;t.default=a},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return P})),n.d(t,"ENHANCED_ES_SEARCH_STRATEGY",(function(){return R.ENHANCED_ES_SEARCH_STRATEGY})),n.d(t,"EQL_SEARCH_STRATEGY",(function(){return R.EQL_SEARCH_STRATEGY}));var s=n(7),a=n.n(s),o=n(0),r=n.n(o),i=n(12),c=n.n(i),u=n(15),l=n(6),d=n(3),p=n(4),b=n(8),f=n.n(b),_=n(5),S=n(13),h=n.n(S),g=n(9),m=n(2);const j=()=>Object(m.jsx)(g.EuiDelayRender,null,Object(m.jsx)(g.EuiLoadingSpinner,null)),O=r.a.lazy((()=>n.e(2).then(n.bind(null,49)))),k=r.a.forwardRef(((e,t)=>Object(m.jsx)(r.a.Suspense,{fallback:Object(m.jsx)(j,null)},Object(m.jsx)(O,h()({},e,{ref:t})))));var v=n(1),E=n(11);const x="data.searchSession.tour.takingTooLong",D="data.searchSession.tour.restore";function C(e,t){try{return Boolean(e.get(t))}catch(e){return!0}}function T(e,t){try{e.set(t,!0)}catch(e){return!0}}const y=({sessionService:e,application:t,storage:n,disableSaveAfterSessionCompletesTimeout:s,usageCollector:a,basePath:r,tourDisabled:i})=>{const c=r.prepend("/app/management/kibana/search_sessions"),u=e.state$.pipe(Object(d.debounce)((e=>Object(p.timer)(e===v.SearchSessionState.None?50:300)))),b=e.state$.pipe(Object(d.switchMap)((e=>e===v.SearchSessionState.Completed?Object(p.merge)(Object(p.of)(!1),Object(p.timer)(s).pipe(Object(d.mapTo)(!0))):Object(p.of)(!1))),Object(d.distinctUntilChanged)(),Object(d.tap)((e=>{e&&(null==a||a.trackSessionIndicatorSaveDisabled())})));return()=>{const s=f()(u,v.SearchSessionState.None),r=e.getSearchSessionIndicatorUiConfig().isDisabled(),d=f()(b,!1),[p,S]=Object(o.useState)(null),h=Object(o.useCallback)((e=>{null!==e&&S(e)}),[]);let g=!1,j="",O=!1,y="";d&&(g=!0,j=_.i18n.translate("xpack.data.searchSessionIndicator.disabledDueToTimeoutMessage",{defaultMessage:"Search session results expired."})),r.disabled&&(g=!0,j=r.reasonText),e.hasAccess()||(O=g=!0,y=j=_.i18n.translate("xpack.data.searchSessionIndicator.disabledDueToDisabledGloballyMessage",{defaultMessage:"You don't have permissions to manage search sessions"}));const{markOpenedDone:w,markRestoredDone:R}=function(e,t,n,s,a,r){const i=Object(o.useCallback)((()=>{T(e,x)}),[e]),c=Object(o.useCallback)((()=>{T(e,D)}),[e]),u=Object(o.useCallback)(Object(E.once)((()=>null==r?void 0:r.trackSessionIndicatorTourLoading())),[r,n]),l=Object(o.useCallback)(Object(E.once)((()=>null==r?void 0:r.trackSessionIndicatorTourRestored())),[r,n]);return Object(o.useEffect)((()=>{if(s)return;if(a)return;if(!t)return;let o;return n===v.SearchSessionState.Loading&&(C(e,x)||(o=window.setTimeout((()=>{u(),t.openPopover()}),1e4))),n===v.SearchSessionState.Restored&&(C(e,D)||(l(),t.openPopover())),()=>{clearTimeout(o)}}),[e,t,n,s,a,i,c,r,l,u]),{markOpenedDone:i,markRestoredDone:c}}(n,p,s,g,i,a),P=Object(o.useCallback)((e=>{w(),e===v.SearchSessionState.Restored&&R()}),[w,R]),M=Object(o.useCallback)((()=>{g||(null==a||a.trackSessionSentToBackground(),e.save())}),[g]),A=Object(o.useCallback)((()=>{g||(null==a||a.trackSessionSavedResults(),e.save())}),[g]),I=Object(o.useCallback)((()=>{null==a||a.trackSessionCancelled(),e.cancel()}),[]),L=Object(o.useCallback)((()=>{null==a||a.trackViewSessionsList()}),[]);Object(o.useEffect)((()=>{s===v.SearchSessionState.Restored&&(null==a||a.trackSessionIsRestored())}),[s]);const{name:N,startTime:B,completedTime:H,canceledTime:G}=f()(e.sessionMeta$,{state:s}),Y=Object(o.useCallback)((async t=>{await e.renameCurrentSession(t)}),[]);return e.isSessionStorageReady()?Object(m.jsx)(l.RedirectAppLinks,{application:t},Object(m.jsx)(k,{ref:h,state:s,saveDisabled:g,saveDisabledReasonText:j,managementDisabled:O,managementDisabledReasonText:y,onContinueInBackground:M,onSaveResults:A,onCancel:I,onOpened:P,onViewSearchSessions:L,viewSearchSessionsLink:c,searchSessionName:N,saveSearchSessionNameFn:Y,startedTime:B,completedTime:H,canceledTime:G})):null}};var w=n(16);class plugin_DataEnhancedPlugin{constructor(e){a()(this,"config",void 0),a()(this,"storage",new w.Storage(window.localStorage)),a()(this,"usageCollector",void 0),this.initializerContext=e}setup(e,{bfetch:t,data:n,management:s}){if(this.config=this.initializerContext.config.get(),this.config.search.sessions.enabled){const t=this.config.search.sessions;Object(u.b)(e,t,this.initializerContext.env.packageInfo.version,{data:n,management:s})}this.usageCollector=n.search.usageCollector}start(e,t){this.config.search.sessions.enabled&&e.chrome.setBreadcrumbsAppendExtension({content:Object(l.toMountPoint)(r.a.createElement(y({sessionService:t.data.search.session,application:e.application,basePath:e.http.basePath,storage:this.storage,disableSaveAfterSessionCompletesTimeout:c.a.duration(this.config.search.sessions.notTouchedTimeout).asMilliseconds(),usageCollector:this.usageCollector,tourDisabled:t.screenshotMode.isScreenshotMode()})))})}stop(){}}var R=n(10);const P=e=>new plugin_DataEnhancedPlugin(e)},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.ReactDom}]);