/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,c,a=t[0],o=t[1],r=0,l=[];r<a.length;r++)c=a[r],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&l.push(i[c][0]),i[c]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(s&&s(t);l.length;)l.shift()()}var n={},i={0:0};function c(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,c),i.l=!0,i.exports}c.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,c){n=i[e]=[t,c]}));t.push(n[2]=a);var o,r=document.createElement("script");r.charset="utf-8",r.timeout=120,c.nc&&r.setAttribute("nonce",c.nc),r.src=function(e){return c.p+"indexLifecycleManagement.chunk."+e+".js"}(e);var s=new Error;o=function(t){r.onerror=r.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var c=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+c+": "+a+")",s.name="ChunkLoadError",s.type=c,s.request=a,n[1](s)}i[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:r})}),12e4);r.onerror=r.onload=o,document.head.appendChild(r)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var a=window.indexLifecycleManagement_bundle_jsonpfunction=window.indexLifecycleManagement_bundle_jsonpfunction||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var r=0;r<a.length;r++)t(a[r]);var s=o;c(c.s=23)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){e.exports=n(22)(1075)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d}));var i=n(17);let c;function a(e){c=e}function o(e){const t="/api/index_lifecycle_management";return e?`${t}/${e}`:t}function r(e,t,n){return c.post(o(e),{body:JSON.stringify(t),query:n})}function s(e,t){return c.get(o(e),{query:t})}function l(e){return c.delete(o(e))}const d=e=>Object(i.useRequest)(c,{...e,path:o(e.path)})},function(e,t,n){"use strict";n.d(t,"o",(function(){return i})),n.d(t,"q",(function(){return c})),n.d(t,"p",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return x})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return h}));const i={hot:"100",warm:"50",cold:"0",frozen:"0"},c={max_age:"30d",max_primary_shard_size:"50gb"},a={name:"",phases:{hot:{actions:{rollover:c}}}},o="index_lifecycle_management",r="app_load",s="policy_create",l="policy_update",d="policy_delete",u="policy_attach_index",f="policy_attach_index_template",m="policy_detach_index",p="config_cold_phase",x="config_warm_phase",g="config_set_priority",y="config_freeze_index",b="index_retry_step",h="edit_click"},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";let i,c;function a(e,t){i=e,c=t}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var i=n(6);let c=(e,t)=>{};function a(e){e&&(c=e.reportUiCounter.bind(e,i.b))}function o(e){return[{metric:i.c,isTracked:()=>Boolean(e.cold)},{metric:i.f,isTracked:()=>Boolean(e.warm)},{metric:i.e,isTracked:()=>{const t=e.hot&&e.hot.actions.set_priority&&e.hot.actions.set_priority.priority!==parseInt(i.o.hot,10),n=e.warm&&e.warm.actions.set_priority&&e.warm.actions.set_priority.priority!==parseInt(i.o.warm,10),c=e.cold&&e.cold.actions.set_priority&&e.cold.actions.set_priority.priority!==parseInt(i.o.cold,10);return t||n||c}},{metric:i.d,isTracked:()=>e.cold&&e.cold.actions.freeze}].reduce(((e,{metric:t,isTracked:n})=>(n()&&e.push(t),e)),[])}},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"k",(function(){return u})),n.d(t,"g",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return x})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return h}));var i=n(14),c=n(6),a=n(9),o=n(5);const r=()=>Object(o.e)({path:"nodes/list",method:"get",initialData:{nodesByAttributes:{},nodesByRoles:{}}}),s=e=>Object(o.e)({path:`nodes/${e}/details`,method:"get"}),l=(e=!1)=>Object(o.e)({path:"templates",query:{legacy:e},method:"get",initialData:[]});async function d(){return await Object(o.c)("policies")}const u=()=>Object(o.e)({path:"policies",method:"get"});async function f(e){return await Object(o.d)("policies",e)}async function m(e){const t=await Object(o.b)(`policies/${encodeURIComponent(e)}`);return Object(a.c)(i.METRIC_TYPE.COUNT,c.l),t}const p=async e=>{const t=await Object(o.d)("index/retry",{indexNames:e});return Object(a.c)(i.METRIC_TYPE.COUNT,c.h),t},x=async e=>{const t=await Object(o.d)("index/remove",{indexNames:e});return Object(a.c)(i.METRIC_TYPE.COUNT,c.m),t},g=async e=>{const t=await Object(o.d)("index/add",e);return Object(a.c)(i.METRIC_TYPE.COUNT,c.i),t},y=async(e,t=!1)=>{const n=await Object(o.d)("template",e,{legacy:t});return Object(a.c)(i.METRIC_TYPE.COUNT,c.j),n},b=()=>Object(o.e)({path:"snapshot_policies",method:"get",initialData:[]}),h=()=>Object(o.e)({path:"snapshot_repositories",method:"get"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n(2);const c=Object.freeze({warm:["data_warm","data_hot"],cold:["data_cold","data_warm","data_hot"],frozen:["data_frozen","data_cold","data_warm","data_hot"]}),a="enterprise",o={ID:"index_lifecycle_management",minimumLicenseType:"basic",TITLE:i.i18n.translate("xpack.indexLifecycleMgmt.appTitle",{defaultMessage:"Index Lifecycle Policies"})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var i=n(18);const c={list:"/policies",edit:"/policies/edit/:policyName?",create:"/policies/edit"},a=e=>encodeURI(`/policies/edit/${encodeURIComponent(e)}`),o=()=>c.create,r=()=>c.list,s=(e,t)=>t("management",{path:`/data/index_management${Object(i.getIndexListUri)(`ilm.policy="${e}"`,!0)}`})},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(8);function c(e,t){if(e&&e.body){var n;const{error:i,statusCode:c,message:a,attributes:o}=e.body;return{title:t,text:`${c}: ${i}. ${null!=o&&null!==(n=o.causes)&&void 0!==n&&n.length?o.causes[o.causes.length-1]:a}`}}}function a(e,t){const n=c(e,t);if(n)return i.c.addDanger(n);i.a.add(e,t)}},function(e,t,n){"use strict";let i;function c(e){i=e}n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));const a=e=>`${i}${e}`,o=()=>`${i}migrate-index-allocation-filters.html`},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/indexManagement/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/home/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n(24),__kbnBundles__.define("plugin/indexLifecycleManagement/public",n,25)},function(e,t,n){n.p=window.__kbnPublicPath__.indexLifecycleManagement},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return I})),n.d(t,"ILM_LOCATOR_ID",(function(){return C}));var i=n(4),c=n.n(i),a=n(19),o=n(2),r=n(20),s=n(12),l=n(5),d=n(16),u=n(9),f=n(8);const m=function(){const e=[{text:o.i18n.translate("xpack.indexLifecycleMgmt.breadcrumb.homeLabel",{defaultMessage:"Index Lifecycle Management"}),href:"/policies"}];return{policies:e,editPolicy:[...e,{text:o.i18n.translate("xpack.indexLifecycleMgmt.breadcrumb.editPolicyLabel",{defaultMessage:"Edit policy"}),href:void 0}]}}();class breadcrumbs_BreadcrumbService{constructor(){c()(this,"setBreadcrumbsHandler",void 0)}setup(e){this.setBreadcrumbsHandler=e}setBreadcrumbs(e){if(!this.setBreadcrumbsHandler)throw new Error("BreadcrumbService#setup() must be called first!");const t=m[e]?[...m[e]]:[...m.policies],n=t.pop();t.push({...n,href:void 0}),this.setBreadcrumbsHandler(t)}}var p=n(7),x=n.n(p),g=n(10),y=n(1),b=n(11),h=n(21),M=n.n(h),_=n(3),j=n(13),O=n(0);class index_lifecycle_summary_IndexLifecycleSummary extends p.Component{constructor(e){super(e),c()(this,"toggleStackPopover",(()=>{this.setState({showStackPopover:!this.state.showStackPopover})})),c()(this,"closeStackPopover",(()=>{this.setState({showStackPopover:!1})})),c()(this,"togglePhaseExecutionPopover",(()=>{this.setState({showPhaseExecutionPopover:!this.state.showPhaseExecutionPopover})})),c()(this,"closePhaseExecutionPopover",(()=>{this.setState({showPhaseExecutionPopover:!1})})),this.state={showStackPopover:!1,showPhaseExecutionPopover:!1}}renderStackPopoverButton(e){if(!e.step_info.stack_trace)return null;const t=Object(O.jsx)(y.EuiButtonEmpty,{onClick:this.toggleStackPopover},Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Stack trace",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.stackTraceButton"}));return Object(O.jsx)(y.EuiPopover,{id:"stackPopover",button:t,isOpen:this.state.showStackPopover,closePopover:this.closeStackPopover},Object(O.jsx)("div",{style:{maxHeight:"400px",width:"900px",overflowY:"scroll"}},Object(O.jsx)("pre",null,e.step_info.stack_trace)))}renderPhaseExecutionPopoverButton(e){const t=Object(O.jsx)(y.EuiLink,{onClick:this.togglePhaseExecutionPopover},Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Show definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.showPhaseDefinitionButton"}));return Object(O.jsx)(p.Fragment,{key:"phaseDefinition"},Object(O.jsx)(y.EuiDescriptionListTitle,{key:"phaseDefinition_title"},Object(O.jsx)("strong",null,Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Phase definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.showPhaseDefinitionDescriptionTitle"}))),Object(O.jsx)(y.EuiDescriptionListDescription,{key:"phaseDefinition_desc"},Object(O.jsx)(y.EuiPopover,{key:"phaseExecutionPopover",id:"phaseExecutionPopover",button:t,isOpen:this.state.showPhaseExecutionPopover,closePopover:this.closePhaseExecutionPopover},Object(O.jsx)(y.EuiPopoverTitle,null,Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Phase definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.phaseDefinitionTitle"})),Object(O.jsx)(y.EuiCodeBlock,{lang:"json"},JSON.stringify(e.phase_execution,null,2)))))}buildRows(){const{index:{ilm:e}}=this.props,t=[["policy",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.lifecyclePolicyHeader",{defaultMessage:"Lifecycle policy"})],["phase",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentPhaseHeader",{defaultMessage:"Current phase"})],["action",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentActionHeader",{defaultMessage:"Current action"})],["action_time_millis",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentActionTimeHeader",{defaultMessage:"Current action time"})],["failed_step",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.failedStepHeader",{defaultMessage:"Failed step"})]],n={left:[],right:[]};return t.forEach((([t,i],c)=>{const a=e[t];let o;o="action_time_millis"===t?M()(a).format("YYYY-MM-DD HH:mm:ss"):"policy"===t?Object(O.jsx)(y.EuiLink,{href:this.props.getUrlForApp("management",{path:`data/index_lifecycle_management/${Object(j.e)(a)}`})},a):a,o=o||"-";const r=Object(O.jsx)(p.Fragment,{key:String(c)},Object(O.jsx)(y.EuiDescriptionListTitle,{key:t},Object(O.jsx)("strong",null,i)),Object(O.jsx)(y.EuiDescriptionListDescription,{key:t+"_desc"},o));c%2==0?n.left.push(r):n.right.push(r)})),e.phase_execution&&n.right.push(this.renderPhaseExecutionPopoverButton(e)),n}render(){const{index:{ilm:e}}=this.props;if(!e.managed)return null;const{left:t,right:n}=this.buildRows();return Object(O.jsx)(x.a.Fragment,null,Object(O.jsx)(y.EuiTitle,{size:"s"},Object(O.jsx)("h3",null,Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Index lifecycle management",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.summaryTitle"}))),e.step_info&&e.step_info.type?Object(O.jsx)(x.a.Fragment,null,Object(O.jsx)(y.EuiSpacer,{size:"s"}),Object(O.jsx)(y.EuiCallOut,{color:"danger",title:Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Index lifecycle error",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.summaryErrorMessage"}),iconType:"cross"},e.step_info.type,": ",e.step_info.reason,Object(O.jsx)(y.EuiSpacer,{size:"s"}),this.renderStackPopoverButton(e))):null,e.step_info&&e.step_info.message&&!e.step_info.stack_trace?Object(O.jsx)(x.a.Fragment,null,Object(O.jsx)(y.EuiSpacer,{size:"s"}),Object(O.jsx)(y.EuiCallOut,{color:"primary",title:Object(O.jsx)(_.FormattedMessage,{defaultMessage:"Action status",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.actionStatusTitle"})},e.step_info.message)):null,Object(O.jsx)(y.EuiSpacer,{size:"m"}),Object(O.jsx)(y.EuiFlexGroup,null,Object(O.jsx)(y.EuiFlexItem,null,Object(O.jsx)(y.EuiDescriptionList,{type:"column"},t)),Object(O.jsx)(y.EuiFlexItem,null,Object(O.jsx)(y.EuiDescriptionList,{type:"column"},n))))}}var L=n(15);class add_lifecycle_confirm_modal_AddLifecyclePolicyConfirmModal extends p.Component{constructor(e){super(e),c()(this,"addPolicy",(async()=>{const{indexName:e,closeModal:t,reloadIndices:n}=this.props,{selectedPolicyName:i,selectedAlias:c}=this.state;if(i)try{const a={indexName:e,policyName:i,alias:c};await Object(b.a)(a),t(),f.c.addSuccess(o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyToIndexSuccess",{defaultMessage:"Added policy {policyName} to index {indexName}.",values:{policyName:i,indexName:e}})),n()}catch(e){Object(L.a)(e,o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyToIndexError",{defaultMessage:"Error adding policy to index"}))}else this.setState({policyErrorMessage:o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.noPolicySelectedErrorMessage",{defaultMessage:"You must select a policy."})})})),c()(this,"renderAliasFormElement",(e=>{const{selectedAlias:t}=this.state,{index:n}=this.props;if(!(e&&Object(g.get)(e,"policy.phases.hot.actions.rollover")))return null;const{aliases:i}=n;if("none"===i)return Object(O.jsx)(p.Fragment,null,Object(O.jsx)(y.EuiSpacer,{size:"m"}),Object(O.jsx)(y.EuiCallOut,{style:{maxWidth:400},title:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.indexHasNoAliasesWarningTitle",defaultMessage:"Index has no aliases"}),color:"warning"},Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.indexHasNoAliasesWarningMessage",defaultMessage:"Policy {policyName} is configured for rollover, but index {indexName} does not have an alias, which is required for rollover.",values:{policyName:null==e?void 0:e.name,indexName:n.name}})));const c=i.map((e=>({text:e,value:e})));return c.unshift({text:o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.chooseAliasMessage",{defaultMessage:"Choose an alias"}),value:""}),Object(O.jsx)(y.EuiFormRow,{label:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.chooseAliasLabel",defaultMessage:"Index rollover alias"})},Object(O.jsx)(y.EuiSelect,{options:c,value:t,onChange:e=>{this.setState({selectedAlias:e.target.value})}}))})),this.state={policies:[],selectedPolicyName:"",selectedAlias:""}}renderForm(){const{policies:e,selectedPolicyName:t,policyErrorMessage:n}=this.state,i=t?e.find((e=>e.name===t)):void 0,c=e.map((({name:e})=>({value:e,text:e})));return c.unshift({value:"",text:o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.choosePolicyMessage",{defaultMessage:"Select a lifecycle policy"})}),Object(O.jsx)(y.EuiForm,null,Object(O.jsx)(y.EuiFormRow,{isInvalid:!!n,error:n,label:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.choosePolicyLabel",defaultMessage:"Lifecycle policy"})},Object(O.jsx)(y.EuiSelect,{options:c,value:t,onChange:e=>{this.setState({policyErrorMessage:void 0,selectedPolicyName:e.target.value})}})),this.renderAliasFormElement(i))}async componentDidMount(){try{const e=await Object(b.d)();this.setState({policies:e})}catch(e){Object(L.a)(e,o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.loadPolicyError",{defaultMessage:"Error loading policy list"})),this.props.closeModal()}}render(){const{policies:e}=this.state,{indexName:t,closeModal:n,getUrlForApp:i}=this.props,c=Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.modalTitle",defaultMessage:'Add lifecycle policy to "{indexName}"',values:{indexName:t}});return e.length?Object(O.jsx)(y.EuiConfirmModal,{title:c,onCancel:n,onConfirm:this.addPolicy,cancelButtonText:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.cancelButtonText",defaultMessage:"Cancel"}),confirmButtonText:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyButtonText",defaultMessage:"Add policy"})},this.renderForm()):Object(O.jsx)(y.EuiModal,{onClose:n},Object(O.jsx)(y.EuiModalHeader,null,Object(O.jsx)(y.EuiModalHeaderTitle,null,c)),Object(O.jsx)(y.EuiModalBody,null,Object(O.jsx)(y.EuiCallOut,{style:{maxWidth:400},title:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.noPoliciesWarningTitle",defaultMessage:"No index lifecycle policies defined"}),color:"warning"},Object(O.jsx)("p",null,Object(O.jsx)(y.EuiLink,{href:i("management",{path:"data/index_lifecycle_management/policies/edit"})},Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.defineLifecyclePolicyLinkText",defaultMessage:"Define lifecycle policy"}))))))}}class remove_lifecycle_confirm_modal_RemoveLifecyclePolicyConfirmModal extends p.Component{constructor(...e){super(...e),c()(this,"removePolicy",(async()=>{const{indexNames:e,closeModal:t,reloadIndices:n}=this.props;try{await Object(b.e)(e),t(),f.c.addSuccess(o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicySuccess",{defaultMessage:"Removed lifecycle policy from {count, plural, one {index} other {indices}}",values:{count:e.length}})),n()}catch(e){Object(L.a)(e,o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicyToIndexError",{defaultMessage:"Error removing policy"}))}}))}render(){const{closeModal:e,indexNames:t}=this.props;return Object(O.jsx)(y.EuiConfirmModal,{title:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.modalTitle",defaultMessage:"Remove lifecycle policy from {count, plural, one {index} other {indices}}",values:{count:t.length}}),onCancel:e,onConfirm:this.removePolicy,cancelButtonText:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.cancelButtonText",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicyButtonText",defaultMessage:"Remove policy"})},Object(O.jsx)(p.Fragment,null,Object(O.jsx)("p",null,Object(O.jsx)(_.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removeMessage",defaultMessage:"You are about to remove the index lifecycle policy from {count, plural, one {this index} other {these indices}}. This operation cannot be undone.",values:{count:t.length}})),Object(O.jsx)("ul",null,t.map((e=>Object(O.jsx)("li",{key:e},e))))))}}const v="ilm.step",P=({indices:e})=>{if(!Object(g.every)(e,(e=>e.ilm&&e.ilm.failed_step)))return null;const t=e.map((({name:e})=>e));return{requestMethod:b.f,icon:"play",indexNames:[t],buttonLabel:o.i18n.translate("xpack.indexLifecycleMgmt.retryIndexLifecycleActionButtonLabel",{defaultMessage:"Retry lifecycle step"}),successMessage:o.i18n.translate("xpack.indexLifecycleMgmt.retryIndexLifecycleAction.retriedLifecycleMessage",{defaultMessage:"Called retry lifecycle step for: {indexNames}",values:{indexNames:t.map((e=>`"${e}"`)).join(", ")}})}},k=({indices:e,reloadIndices:t})=>{if(!Object(g.every)(e,(e=>e.ilm&&e.ilm.managed)))return null;const n=e.map((({name:e})=>e));return{renderConfirmModal:e=>Object(O.jsx)(remove_lifecycle_confirm_modal_RemoveLifecyclePolicyConfirmModal,{indexNames:n,closeModal:e,reloadIndices:t}),icon:"stopFilled",indexNames:[n],buttonLabel:o.i18n.translate("xpack.indexLifecycleMgmt.removeIndexLifecycleActionButtonLabel",{defaultMessage:"Remove lifecycle policy"})}},E=({indices:e,reloadIndices:t,getUrlForApp:n})=>{if(1!==e.length)return null;const i=e[0];if(i.ilm&&i.ilm.managed)return null;const c=i.name;return{renderConfirmModal:e=>Object(O.jsx)(add_lifecycle_confirm_modal_AddLifecyclePolicyConfirmModal,{indexName:c,closeModal:e,index:i,reloadIndices:t,getUrlForApp:n}),icon:"plusInCircle",buttonLabel:o.i18n.translate("xpack.indexLifecycleMgmt.addLifecyclePolicyActionButtonLabel",{defaultMessage:"Add lifecycle policy"})}},S=e=>{const{Query:t}=y.EuiSearchBar;if(!e.length)return null;const n=e.filter((e=>"ERROR"===Object(g.get)(e,v))).length;return n?{type:"warning",filter:t.parse(`${v}:ERROR`),filterLabel:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtBanner.filterLabel",{defaultMessage:"Show errors"}),title:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtBanner.errorMessage",{defaultMessage:"{ numIndicesWithLifecycleErrors, number}\n          {numIndicesWithLifecycleErrors, plural, one {index has} other {indices have} }\n          lifecycle errors",values:{numIndicesWithLifecycleErrors:n}})}:null},T=(e,t)=>Object(O.jsx)(index_lifecycle_summary_IndexLifecycleSummary,{index:e,getUrlForApp:t}),w=e=>Object(g.some)(e,(e=>e.ilm&&e.ilm.managed))?[{type:"field_value_selection",name:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.lifecycleStatusLabel",{defaultMessage:"Lifecycle status"}),multiSelect:!1,field:"ilm.managed",options:[{value:!0,view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.managedLabel",{defaultMessage:"Managed"})},{value:!1,view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.unmanagedLabel",{defaultMessage:"Unmanaged"})}]},{type:"field_value_selection",field:"ilm.phase",name:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.lifecyclePhaseLabel",{defaultMessage:"Lifecycle phase"}),multiSelect:"or",options:[{value:"hot",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.hotLabel",{defaultMessage:"Hot"})},{value:"warm",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.warmLabel",{defaultMessage:"Warm"})},{value:"frozen",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.frozenLabel",{defaultMessage:"Frozen"})},{value:"cold",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.coldLabel",{defaultMessage:"Cold"})},{value:"delete",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.deleteLabel",{defaultMessage:"Delete"})}]}]:[],C="ILM_LOCATOR_ID";class locator_IlmLocatorDefinition{constructor(e){c()(this,"id",C),c()(this,"getLocation",(async e=>{const t=await this.deps.managementAppLocator.getLocation({sectionId:"data",appId:s.b.ID});switch(e.page){case"policy_create":return{...t,path:t.path+Object(j.d)()};case"policy_edit":return{...t,path:t.path+Object(j.e)(e.policyName)};case"policies_list":return{...t,path:t.path+Object(j.c)()}}})),this.deps=e}}class plugin_IndexLifecycleManagementPlugin{constructor(e){c()(this,"breadcrumbService",new breadcrumbs_BreadcrumbService),this.initializerContext=e}setup(e,t){const{ui:{enabled:i}}=this.initializerContext.config.get();if(i){const{http:i,notifications:{toasts:m},fatalErrors:p,getStartServices:x}=e,{usageCollection:g,management:y,indexManagement:b,home:h,cloud:M}=t;Object(l.a)(i),Object(u.b)(g),Object(f.b)(m,p),y.sections.section.data.registerApp({id:s.b.ID,title:s.b.TITLE,order:2,mount:async({element:e,history:t,setBreadcrumbs:i})=>{const[c,{licensing:o}]=await x(),{chrome:{docTitle:r},i18n:{Context:l},docLinks:{ELASTIC_WEBSITE_URL:u,DOC_LINK_VERSION:f},application:m}=c,p=await o.license$.pipe(Object(a.first)()).toPromise();r.change(s.b.TITLE),this.breadcrumbService.setup(i),Object(d.c)(`${u}guide/en/elasticsearch/reference/${f}/`);const{renderApp:g}=await n.e(1).then(n.bind(null,107)),y=g(e,l,t,m,this.breadcrumbService,p,M);return()=>{r.reset(),y()}}}),h&&h.featureCatalogue.register({id:s.b.ID,title:o.i18n.translate("xpack.indexLifecycleMgmt.featureCatalogueTitle",{defaultMessage:"Manage index lifecycles"}),description:o.i18n.translate("xpack.indexLifecycleMgmt.featureCatalogueDescription",{defaultMessage:"Define lifecycle policies to automatically perform operations as an index ages."}),icon:"indexRollupApp",path:"/app/management/data/index_lifecycle_management",showOnHomePage:!0,category:r.FeatureCatalogueCategory.ADMIN,order:640}),b&&((c=b.extensionsService).addAction(P),c.addAction(k),c.addAction(E),c.addBanner(S),c.addSummary(T),c.addFilter(w)),t.share.url.locators.create(new locator_IlmLocatorDefinition({managementAppLocator:t.management.locator}))}var c}start(){}stop(){}}const I=e=>new plugin_IndexLifecycleManagementPlugin(e)},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.ReactDom}]);