/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(t){function e(e){for(var n,r,s=e[0],o=e[1],a=0,u=[];a<s.length;a++)r=s[a],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);for(c&&c(e);u.length;)u.shift()()}var n={},i={1:0};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var s=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.src=function(t){return r.p+"reporting.chunk."+t+".js"}(t);var c=new Error;o=function(e){a.onerror=a.onload=null,clearTimeout(u);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",c.name="ChunkLoadError",c.type=r,c.request=s,n[1](c)}i[t]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var s=window.reporting_bundle_jsonpfunction=window.reporting_bundle_jsonpfunction||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var a=0;a<s.length;a++)e(s[a]);var c=o;r(r.s=26)}([function(t,e){t.exports=__kbnSharedDeps__.EmotionReact},function(t,e,n){t.exports=n(19)(1075)},function(t,e,n){"use strict";n.r(e),n.d(e,"PLUGIN_ID",(function(){return i})),n.d(e,"REPORTING_TRANSACTION_TYPE",(function(){return r})),n.d(e,"JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY",(function(){return s})),n.d(e,"CONTENT_TYPE_CSV",(function(){return o})),n.d(e,"CSV_REPORTING_ACTION",(function(){return a})),n.d(e,"CSV_BOM_CHARS",(function(){return c})),n.d(e,"CSV_FORMULA_CHARS",(function(){return u})),n.d(e,"ALLOWED_JOB_CONTENT_TYPES",(function(){return l})),n.d(e,"KBN_SCREENSHOT_HEADER_BLOCK_LIST",(function(){return p})),n.d(e,"KBN_SCREENSHOT_HEADER_BLOCK_LIST_STARTS_WITH_PATTERN",(function(){return d})),n.d(e,"UI_SETTINGS_SEARCH_INCLUDE_FROZEN",(function(){return g})),n.d(e,"UI_SETTINGS_CUSTOM_PDF_LOGO",(function(){return h})),n.d(e,"UI_SETTINGS_CSV_SEPARATOR",(function(){return b})),n.d(e,"UI_SETTINGS_CSV_QUOTE_VALUES",(function(){return f})),n.d(e,"UI_SETTINGS_DATEFORMAT_TZ",(function(){return _})),n.d(e,"LAYOUT_TYPES",(function(){return m})),n.d(e,"DEFAULT_VIEWPORT",(function(){return j})),n.d(e,"CSV_SAVED_OBJECT_JOB_TYPE",(function(){return O})),n.d(e,"CSV_REPORT_TYPE",(function(){return S})),n.d(e,"CSV_JOB_TYPE",(function(){return T})),n.d(e,"PDF_REPORT_TYPE",(function(){return E})),n.d(e,"PDF_REPORT_TYPE_V2",(function(){return v})),n.d(e,"PDF_JOB_TYPE",(function(){return y})),n.d(e,"PDF_JOB_TYPE_V2",(function(){return P})),n.d(e,"PNG_REPORT_TYPE",(function(){return x})),n.d(e,"PNG_REPORT_TYPE_V2",(function(){return R})),n.d(e,"PNG_JOB_TYPE",(function(){return C})),n.d(e,"PNG_JOB_TYPE_V2",(function(){return I})),n.d(e,"CSV_SEARCHSOURCE_IMMEDIATE_TYPE",(function(){return w})),n.d(e,"CSV_REPORT_TYPE_DEPRECATED",(function(){return M})),n.d(e,"CSV_JOB_TYPE_DEPRECATED",(function(){return A})),n.d(e,"USES_HEADLESS_JOB_TYPES",(function(){return k})),n.d(e,"DEPRECATED_JOB_TYPES",(function(){return N})),n.d(e,"LICENSE_TYPE_TRIAL",(function(){return D})),n.d(e,"LICENSE_TYPE_BASIC",(function(){return L})),n.d(e,"LICENSE_TYPE_CLOUD_STANDARD",(function(){return F})),n.d(e,"LICENSE_TYPE_GOLD",(function(){return U})),n.d(e,"LICENSE_TYPE_PLATINUM",(function(){return B})),n.d(e,"LICENSE_TYPE_ENTERPRISE",(function(){return $})),n.d(e,"API_BASE_URL",(function(){return Y})),n.d(e,"API_BASE_GENERATE",(function(){return V})),n.d(e,"API_LIST_URL",(function(){return G})),n.d(e,"API_DIAGNOSE_URL",(function(){return J})),n.d(e,"API_GET_ILM_POLICY_STATUS",(function(){return z})),n.d(e,"API_MIGRATE_ILM_POLICY_URL",(function(){return q})),n.d(e,"API_BASE_URL_V1",(function(){return H})),n.d(e,"ILM_POLICY_NAME",(function(){return W})),n.d(e,"REPORTING_MANAGEMENT_HOME",(function(){return K})),n.d(e,"REPORTING_REDIRECT_LOCATOR_STORE_KEY",(function(){return X})),n.d(e,"getRedirectAppPath",(function(){return Z})),n.d(e,"JOB_STATUSES",(function(){return Q})),n.d(e,"REPORT_TABLE_ID",(function(){return tt})),n.d(e,"REPORT_TABLE_ROW_ID",(function(){return et})),n.d(e,"UNVERSIONED_VERSION",(function(){return nt})),n.d(e,"API_GENERATE_IMMEDIATE",(function(){return it}));const i="reporting",r=i,s="xpack.reporting.jobCompletionNotifications",o="text/csv",a="downloadCsvReport",c="\ufeff",u=["=","+","-","@"],l=["application/json","application/pdf",o,"image/png","text/plain"],p=["accept-encoding","connection","content-length","content-type","host","referer","transfer-encoding","trailer","te","upgrade","keep-alive"],d=["proxy-"],g="search:includeFrozen",h="xpackReporting:customPdfLogo",b="csv:separator",f="csv:quoteValues",_="dateFormat:tz",m={CANVAS:"canvas",PRESERVE_LAYOUT:"preserve_layout",PRINT:"print"},j={width:1950,height:1200,deviceScaleFactor:1},O="csv_saved_object",S="CSV",T="csv_searchsource",E="printablePdf",v="printablePdfV2",y="printable_pdf",P="printable_pdf_v2",x="PNG",R="pngV2",C="PNG",I="PNGV2",w="csv_searchsource_immediate",M="CSV",A="csv",k=[y,C],N=[A],D="trial",L="basic",F="standard",U="gold",B="platinum",$="enterprise",Y="/api/reporting",V=`${Y}/generate`,G=`${Y}/jobs`,J=`${Y}/diagnose`,z=`${Y}/ilm_policy_status`,q=`${Y}/deprecations/migrate_ilm_policy`,H="/api/reporting/v1",W="kibana-reporting",K="/app/management/insightsAndAlerting/reporting",X="__REPORTING_REDIRECT_LOCATOR_STORE_KEY__",Z=()=>"/app/management/insightsAndAlerting/reporting/r";let Q;!function(t){t.PENDING="pending",t.PROCESSING="processing",t.COMPLETED="completed",t.FAILED="failed",t.WARNINGS="completed_with_warnings"}(Q||(Q={}));const tt="reportJobListing",et="reportJobRow",nt="7.14.0",it=`${H}/generate/immediate/csv_searchsource`},function(t,e){t.exports=__kbnSharedDeps__.KbnI18n},function(t,e){t.exports=__kbnSharedDeps__.React},function(t,e){t.exports=__kbnSharedDeps__.KbnI18nReact},function(t,e){t.exports=__kbnSharedDeps__.ElasticEui},function(t,e,n){n.r(e);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(e,Object.getOwnPropertyDescriptors(i))},function(t,e){t.exports=__kbnSharedDeps__.RxjsOperators},function(t,e){t.exports=__kbnSharedDeps__.Rxjs},function(t,e,n){"use strict";n.d(e,"b",(function(){return s}));var i=n(21);n.d(e,"c",(function(){return i.useRequest}));var r=n(7);n.d(e,"a",(function(){return r.KibanaContextProvider}));const s=()=>Object(r.useKibana)()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const i=t=>{switch(t.state){case"valid":default:return{showLinks:!0,enableLinks:!0,message:""};case"invalid":return{showLinks:!1,enableLinks:!1,message:"Your license does not support Reporting. Please upgrade your license."};case"unavailable":return{showLinks:!0,enableLinks:!1,message:"You cannot use Reporting because license information is not available at this time."};case"expired":return{showLinks:!0,enableLinks:!1,message:"You cannot use Reporting because your license has expired."}}}},function(t,e){t.exports=__kbnSharedDeps__.Moment},function(t,e){t.exports=__kbnSharedDeps__.Lodash},function(t,e,n){"use strict";n.d(e,"b",(function(){return reporting_api_client_ReportingAPIClient})),n.d(e,"c",(function(){return P})),n.d(e,"a",(function(){return R})),n.d(e,"d",(function(){return C}));var i=n(1),r=n.n(i),s=n(3),o=n(12),a=n.n(o),c=n(23),u=n(17),l=n.n(u),p=n(2);const d=t=>{sessionStorage.setItem(p.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY,JSON.stringify(t))},g=()=>{const t=sessionStorage.getItem(p.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY);return t?JSON.parse(t):[]};var h=n(6),b=n(5),f=n(4),_=n.n(f),m=n(0);const{COMPLETED:j,FAILED:O,PENDING:S,PROCESSING:T,WARNINGS:E}=p.JOB_STATUSES;class job_Job{constructor(t){var e,n,i,s,o;r()(this,"id",void 0),r()(this,"index",void 0),r()(this,"objectType",void 0),r()(this,"title",void 0),r()(this,"isDeprecated",void 0),r()(this,"browserTimezone",void 0),r()(this,"layout",void 0),r()(this,"jobtype",void 0),r()(this,"created_by",void 0),r()(this,"created_at",void 0),r()(this,"started_at",void 0),r()(this,"completed_at",void 0),r()(this,"status",void 0),r()(this,"attempts",void 0),r()(this,"max_attempts",void 0),r()(this,"timeout",void 0),r()(this,"kibana_name",void 0),r()(this,"kibana_id",void 0),r()(this,"browser_type",void 0),r()(this,"size",void 0),r()(this,"content_type",void 0),r()(this,"csv_contains_formulas",void 0),r()(this,"max_size_reached",void 0),r()(this,"warnings",void 0),this.id=t.id,this.index=t.index,this.jobtype=t.jobtype,this.objectType=t.payload.objectType,this.title=t.payload.title,this.layout=t.payload.layout,this.created_by=t.created_by,this.created_at=t.created_at,this.started_at=t.started_at,this.completed_at=t.completed_at,this.status=t.status,this.attempts=t.attempts,this.max_attempts=t.max_attempts,this.timeout=t.timeout,this.kibana_name=t.kibana_name,this.kibana_id=t.kibana_id,this.browser_type=t.browser_type,this.browserTimezone=t.payload.browserTimezone,this.size=null===(e=t.output)||void 0===e?void 0:e.size,this.content_type=null===(n=t.output)||void 0===n?void 0:n.content_type,this.isDeprecated=t.payload.isDeprecated||!1,this.csv_contains_formulas=null===(i=t.output)||void 0===i?void 0:i.csv_contains_formulas,this.max_size_reached=null===(s=t.output)||void 0===s?void 0:s.max_size_reached,this.warnings=null===(o=t.output)||void 0===o?void 0:o.warnings}getStatusMessage(){const t=this.status;let e,n;return t===S?e=s.i18n.translate("xpack.reporting.jobStatusDetail.pendingStatusReachedText",{defaultMessage:"Waiting for job to process."}):t===T?e=s.i18n.translate("xpack.reporting.jobStatusDetail.attemptXofY",{defaultMessage:"Attempt {attempts} of {max_attempts}.",values:{attempts:this.attempts,max_attempts:this.max_attempts}}):this.getWarnings()?e=s.i18n.translate("xpack.reporting.jobStatusDetail.warningsText",{defaultMessage:"See report info for warnings."}):this.getError()&&(e=s.i18n.translate("xpack.reporting.jobStatusDetail.errorText",{defaultMessage:"See report info for error details."})),this.isDeprecated&&(n=Object(m.jsx)(h.EuiText,{size:"s"}," ",Object(m.jsx)(h.EuiTextColor,{color:"warning"},s.i18n.translate("xpack.reporting.jobStatusDetail.deprecatedText",{defaultMessage:"This is a deprecated export type. Automation of this report will need to be re-created for compatibility with future versions of Kibana."})))),e?Object(m.jsx)(_.a.Fragment,null,Object(m.jsx)(h.EuiText,{size:"s"},Object(m.jsx)(h.EuiTextColor,{color:"subdued"},e)),n||null):null}getStatus(){const t=v.get(this.status),e=this.getStatusTimestamp();return e?Object(m.jsx)(b.FormattedMessage,{id:"xpack.reporting.jobStatusDetail.statusTimestampText",defaultMessage:"{statusLabel} at {statusTimestamp}",values:{statusLabel:t,statusTimestamp:Object(m.jsx)("span",{className:"eui-textNoWrap"},this.formatDate(e))}}):t}getStatusLabel(){return Object(m.jsx)(_.a.Fragment,null,this.getStatus()," ",this.getStatusMessage())}getCreatedAtLabel(){return this.created_by?Object(m.jsx)(_.a.Fragment,null,Object(m.jsx)("div",null,this.formatDate(this.created_at)),Object(m.jsx)("span",null,this.created_by)):this.formatDate(this.created_at)}getError(){if(this.status===O)return this.warnings}getWarnings(){var t;const e=[];if(this.isDeprecated&&e.push(s.i18n.translate("xpack.reporting.jobWarning.exportTypeDeprecated",{defaultMessage:"This is a deprecated export type. Automation of this report will need to be re-created for compatibility with future versions of Kibana."})),this.csv_contains_formulas&&e.push(s.i18n.translate("xpack.reporting.jobWarning.csvContainsFormulas",{defaultMessage:"Your CSV contains characters that spreadsheet applications might interpret as formulas."})),this.max_size_reached&&e.push(s.i18n.translate("xpack.reporting.jobWarning.maxSizeReachedTooltip",{defaultMessage:"Your search reached the max size and contains partial data."})),this.status!==O&&null!==(t=this.warnings)&&void 0!==t&&t.length&&e.push(...this.warnings),e.length)return Object(m.jsx)("ul",null,e.map(((t,e)=>Object(m.jsx)("li",{key:`warning-key-${e}`},t))))}formatDate(t){try{return a()(t).format("YYYY-MM-DD @ hh:mm A")}catch(e){return t}}getStatusTimestamp(){const t=this.status;return t===T&&this.started_at?this.started_at:this.completed_at&&[j,O,E].includes(t)?this.completed_at:this.created_at}}const v=new Map([[S,s.i18n.translate("xpack.reporting.jobStatuses.pendingText",{defaultMessage:"Pending"})],[T,s.i18n.translate("xpack.reporting.jobStatuses.processingText",{defaultMessage:"Processing"})],[j,s.i18n.translate("xpack.reporting.jobStatuses.completedText",{defaultMessage:"Completed"})],[E,s.i18n.translate("xpack.reporting.jobStatuses.warningText",{defaultMessage:"Completed"})],[O,s.i18n.translate("xpack.reporting.jobStatuses.failedText",{defaultMessage:"Failed"})]]);class reporting_api_client_ReportingAPIClient{constructor(t,e,n){r()(this,"http",void 0),r()(this,"getManagementLink",(()=>this.http.basePath.prepend(p.REPORTING_MANAGEMENT_HOME))),r()(this,"getDownloadLink",(t=>this.http.basePath.prepend(`${p.API_LIST_URL}/download/${t}`))),r()(this,"getServerBasePath",(()=>this.http.basePath.serverBasePath)),this.uiSettings=e,this.kibanaVersion=n,this.http=t}getReportURL(t){return`${this.http.basePath.prepend(p.API_LIST_URL)}/download/${t}`}downloadReport(t){const e=this.getReportURL(t);window.open(e)}async deleteReport(t){return await this.http.delete(`${p.API_LIST_URL}/delete/${t}`,{asSystemRequest:!0})}async list(t=0,e=[]){const n={page:t};e.length>0&&(n.ids=e.slice(0,10).join(","));return(await this.http.get(`${p.API_LIST_URL}/list`,{query:n,asSystemRequest:!0})).map((t=>new job_Job(t)))}async total(){return await this.http.get(`${p.API_LIST_URL}/count`,{asSystemRequest:!0})}async getError(t){var e;const n=await this.getInfo(t);return null!==(e=n.warnings)&&void 0!==e&&e[0]?n.warnings[0]:s.i18n.translate("xpack.reporting.apiClient.unknownError",{defaultMessage:"Report job {job} failed. Error unknown.",values:{job:t}})}async getInfo(t){const e=await this.http.get(`${p.API_LIST_URL}/info/${t}`,{asSystemRequest:!0});return new job_Job(e)}async findForJobIds(t){return(await this.http.fetch(`${p.API_LIST_URL}/list`,{query:{page:0,ids:t.join(",")},method:"GET"})).map((t=>new job_Job(t)))}getReportingJobPath(t,e){const n=Object(c.stringify)({jobParams:l.a.encode(e)});return`${this.http.basePath.prepend(p.API_BASE_GENERATE)}/${t}?${n}`}async createReportingJob(t,e){const n=l.a.encode(e),i=await this.http.post(`${p.API_BASE_GENERATE}/${t}`,{method:"POST",body:JSON.stringify({jobParams:n})});return(t=>{const e=g();e.push(t),d(e)})(i.job.id),new job_Job(i.job)}async createImmediateReport(t){const{objectType:e,...n}=t;return this.http.post(`${p.API_GENERATE_IMMEDIATE}`,{asResponse:!0,body:JSON.stringify(n)})}getDecoratedJobParams(t){return{browserTimezone:"Browser"===this.uiSettings.get("dateFormat:tz")?a.a.tz.guess():this.uiSettings.get("dateFormat:tz"),version:this.kibanaVersion,...t}}verifyBrowser(){return this.http.post(`${p.API_BASE_URL}/diagnose/browser`,{asSystemRequest:!0})}verifyScreenCapture(){return this.http.post(`${p.API_BASE_URL}/diagnose/screenshot`,{asSystemRequest:!0})}migrateReportingIndicesIlmPolicy(){return this.http.put(`${p.API_MIGRATE_ILM_POLICY_URL}`)}}var y=n(10);const P=()=>{const{services:{http:t}}=Object(y.b)();return Object(y.c)(t,{path:p.API_GET_ILM_POLICY_STATUS,method:"get"})},x=Object(f.createContext)(void 0),R=({apiClient:t,children:e})=>{const{services:{http:n}}=Object(y.b)();return Object(m.jsx)(x.Provider,{value:{http:n,apiClient:t}},e)},C=()=>{const t=Object(f.useContext)(x);if(!t)throw new Error('"useInternalApiClient" can only be used inside of "InternalApiClientContext"');return t}},function(t,e,n){t.exports=n(19)(1076)},function(t,e,n){n.r(e);var i=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(e,Object.getOwnPropertyDescriptors(i))},function(t,e){t.exports=__kbnSharedDeps__.RisonNode},function(t,e,n){n.r(e);var i=__kbnBundles__.get("plugin/discover/public");Object.defineProperties(e,Object.getOwnPropertyDescriptors(i))},function(t,e){t.exports=__kbnSharedDeps_npm__},function(t,e,n){"use strict";n.d(e,"a",(function(){return Poller}));var i=n(1),r=n.n(i),s=n(13),o=n.n(s);class Poller{constructor(t){r()(this,"functionToPoll",void 0),r()(this,"successFunction",void 0),r()(this,"errorFunction",void 0),r()(this,"_isRunning",void 0),r()(this,"_timeoutId",void 0),r()(this,"pollFrequencyInMillis",void 0),r()(this,"trailing",void 0),r()(this,"continuePollingOnError",void 0),r()(this,"pollFrequencyErrorMultiplier",void 0),this.functionToPoll=t.functionToPoll,this.successFunction=t.successFunction||o.a.noop,this.errorFunction=t.errorFunction||o.a.noop,this.pollFrequencyInMillis=t.pollFrequencyInMillis,this.trailing=t.trailing||!1,this.continuePollingOnError=t.continuePollingOnError||!1,this.pollFrequencyErrorMultiplier=t.pollFrequencyErrorMultiplier||1,this._timeoutId=null,this._isRunning=!1}getPollFrequency(){return this.pollFrequencyInMillis}_poll(){return this.functionToPoll().then(this.successFunction).then((()=>{this._isRunning&&(this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis))})).catch((t=>{this.errorFunction(t),this._isRunning&&(this.continuePollingOnError?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis*this.pollFrequencyErrorMultiplier):this.stop())}))}start(){this._isRunning||(this._isRunning=!0,this.trailing?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis):this._poll())}stop(){this._isRunning&&(this._isRunning=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=null)}isRunning(){return this._isRunning}}},function(t,e,n){n.r(e);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(e,Object.getOwnPropertyDescriptors(i))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n(12);const i=t=>"number"==typeof t?t:t.asMilliseconds()},function(t,e,n){"use strict";const i=n(28),r=n(29),s=n(30);function o(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(t,e){return e.encode?e.strict?i(t):encodeURIComponent(t):t}function c(t,e){return e.decode?r(t):t}function u(t){return Array.isArray(t)?t.sort():"object"==typeof t?u(Object.keys(t)).sort(((t,e)=>Number(t)-Number(e))).map((e=>t[e])):t}function l(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function p(t){const e=(t=l(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function d(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function g(t,e){o((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const n=function(t){let e;switch(t.arrayFormat){case"index":return(t,n,i)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===i[t]&&(i[t]={}),i[t][e[1]]=n):i[t]=n};case"bracket":return(t,n,i)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==i[t]?i[t]=[].concat(i[t],n):i[t]=[n]:i[t]=n};case"comma":case"separator":return(e,n,i)=>{const r="string"==typeof n&&n.split("").indexOf(t.arrayFormatSeparator)>-1?n.split(t.arrayFormatSeparator).map((e=>c(e,t))):null===n?n:c(n,t);i[e]=r};default:return(t,e,n)=>{void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e),i=Object.create(null);if("string"!=typeof t)return i;if(!(t=t.trim().replace(/^[?#&]/,"")))return i;for(const r of t.split("&")){let[t,o]=s(e.decode?r.replace(/\+/g," "):r,"=");o=void 0===o?null:["comma","separator"].includes(e.arrayFormat)?o:c(o,e),n(c(t,e),o,i)}for(const t of Object.keys(i)){const n=i[t];if("object"==typeof n&&null!==n)for(const t of Object.keys(n))n[t]=d(n[t],e);else i[t]=d(n,e)}return!1===e.sort?i:(!0===e.sort?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce(((t,e)=>{const n=i[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?t[e]=u(n):t[e]=n,t}),Object.create(null))}e.extract=p,e.parse=g,e.stringify=(t,e)=>{if(!t)return"";o((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const n=n=>e.skipNull&&null==t[n]||e.skipEmptyString&&""===t[n],i=function(t){switch(t.arrayFormat){case"index":return e=>(n,i)=>{const r=n.length;return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[a(e,t),"[",r,"]"].join("")]:[...n,[a(e,t),"[",a(r,t),"]=",a(i,t)].join("")]};case"bracket":return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[a(e,t),"[]"].join("")]:[...n,[a(e,t),"[]=",a(i,t)].join("")];case"comma":case"separator":return e=>(n,i)=>null==i||0===i.length?n:0===n.length?[[a(e,t),"=",a(i,t)].join("")]:[[n,a(i,t)].join(t.arrayFormatSeparator)];default:return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,a(e,t)]:[...n,[a(e,t),"=",a(i,t)].join("")]}}(e),r={};for(const e of Object.keys(t))n(e)||(r[e]=t[e]);const s=Object.keys(r);return!1!==e.sort&&s.sort(e.sort),s.map((n=>{const r=t[n];return void 0===r?"":null===r?a(n,e):Array.isArray(r)?r.reduce(i(n),[]).join("&"):a(n,e)+"="+a(r,e)})).filter((t=>t.length>0)).join("&")},e.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);const[n,i]=s(t,"#");return Object.assign({url:n.split("?")[0]||"",query:g(p(t),e)},e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:c(i,e)}:{})},e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0},n);const i=l(t.url).split("?")[0]||"",r=e.extract(t.url),s=e.parse(r,{sort:!1}),o=Object.assign(s,t.query);let c=e.stringify(o,n);c&&(c=`?${c}`);let u=function(t){let e="";const n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url);return t.fragmentIdentifier&&(u=`#${a(t.fragmentIdentifier,n)}`),`${i}${c}${u}`}},function(t,e,n){n.r(e);var i=__kbnBundles__.get("plugin/home/public");Object.defineProperties(e,Object.getOwnPropertyDescriptors(i))},function(t,e,n){n.r(e);var i=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(e,Object.getOwnPropertyDescriptors(i))},function(t,e,n){n(27),__kbnBundles__.define("plugin/reporting/public",n,31)},function(t,e,n){n.p=window.__kbnPublicPath__.reporting},function(t,e,n){"use strict";t.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,(t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`))},function(t,e,n){"use strict";var i="%[a-f0-9]{2}",r=new RegExp("("+i+")|([^%]+?)","gi"),s=new RegExp("("+i+")+","gi");function o(t,e){try{return[decodeURIComponent(t.join(""))]}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],o(n),o(i))}function a(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(r)||[],n=1;n<e.length;n++)e=(t=o(e,n).join("")).match(r)||[];return t}}t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},n=s.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var i=a(n[0]);i!==n[0]&&(e[n[0]]=i)}n=s.exec(t)}e["%C2"]="�";for(var r=Object.keys(e),o=0;o<r.length;o++){var c=r[o];t=t.replace(new RegExp(c,"g"),e[c])}return t}(t)}}},function(t,e,n){"use strict";t.exports=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]}},function(t,e,n){"use strict";n.r(e),n.d(e,"constants",(function(){return p})),n.d(e,"ReportingAPIClient",(function(){return i.b})),n.d(e,"Plugin",(function(){return plugin_ReportingPublicPlugin})),n.d(e,"plugin",(function(){return F}));var i=n(14),r=n(1),s=n.n(r),o=n(3),a=n(9),c=n(8),u=n(16),l=n(24),p=n(2);n(13);n(20);var d=n(22),g=n(6),h=n(5),b=n(4),f=n(7),_=n(0);const m=(t,e,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.couldNotCreateReportTitle",defaultMessage:"Could not create report for {reportObjectType} '{reportObjectTitle}'.",values:{reportObjectType:e.jobtype,reportObjectTitle:e.title}})),text:Object(f.toMountPoint)(Object(_.jsx)(b.Fragment,null,Object(_.jsx)(g.EuiCallOut,{size:"m",title:o.i18n.translate("xpack.reporting.publicNotifier.error.calloutTitle",{defaultMessage:"The reporting job failed"}),color:"danger",iconType:"alert","data-test-errorText":t},t),Object(_.jsx)(g.EuiSpacer,null),Object(_.jsx)("p",null,Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.checkManagement",defaultMessage:"More information is available at {path}.",values:{path:Object(_.jsx)("a",{href:n()},Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.reportingSectionUrlLinkLabel",defaultMessage:"Management > Kibana > Reporting"}))}})))),iconType:void 0,"data-test-subj":"completeReportFailure"}),j=(t,e)=>({text:Object(f.toMountPoint)(Object(_.jsx)(b.Fragment,null,Object(_.jsx)(g.EuiCallOut,{title:t,color:"danger",iconType:"alert"},e.toString()),Object(_.jsx)(g.EuiSpacer,null),Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.tryRefresh",defaultMessage:"Try refreshing the page."}))),iconType:void 0}),O=({getUrl:t,job:e})=>Object(_.jsx)(g.EuiButton,{size:"s","data-test-subj":"downloadCompletedReportButton",href:t(e.id),target:"_blank"},Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.downloadReportButtonLabel",defaultMessage:"Download report"})),S=({getUrl:t})=>Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLink.pickItUpFromPathDescription",defaultMessage:"Pick it up from {path}.",values:{path:Object(_.jsx)("a",{href:t()},Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLink.reportingSectionUrlLinkLabel",defaultMessage:"Stack Management > Alerts and Insights > Reporting"}))}}),T=(t,e,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.successfullyCreatedReportNotificationTitle",defaultMessage:"Created report for {reportObjectType} '{reportObjectTitle}'",values:{reportObjectType:t.jobtype,reportObjectTitle:t.title}})),color:"success",text:Object(f.toMountPoint)(Object(_.jsx)(b.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(S,{getUrl:e})),Object(_.jsx)(O,{getUrl:n,job:t}))),"data-test-subj":"completeReportSuccess"}),E=(t,e,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.csvContainsFormulas.formulaReportTitle",defaultMessage:"Report may contain formulas {reportObjectType} '{reportObjectTitle}'",values:{reportObjectType:t.jobtype,reportObjectTitle:t.title}})),text:Object(f.toMountPoint)(Object(_.jsx)(b.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.csvContainsFormulas.formulaReportMessage",defaultMessage:"The report contains characters which spreadsheet applications can interpret as formulas."})),Object(_.jsx)("p",null,Object(_.jsx)(S,{getUrl:e})),Object(_.jsx)(O,{getUrl:n,job:t}))),"data-test-subj":"completeReportCsvFormulasWarning"}),v=(t,e,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.maxSizeReached.partialReportTitle",defaultMessage:"Created partial report for {reportObjectType} '{reportObjectTitle}'",values:{reportObjectType:t.jobtype,reportObjectTitle:t.title}})),text:Object(f.toMountPoint)(Object(_.jsx)(b.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(h.FormattedMessage,{id:"xpack.reporting.publicNotifier.maxSizeReached.partialReportDescription",defaultMessage:"The report reached the max size and contains partial data."})),Object(_.jsx)("p",null,Object(_.jsx)(S,{getUrl:e})),Object(_.jsx)(O,{getUrl:n,job:t}))),"data-test-subj":"completeReportMaxSizeWarning"});function y(t){return{id:t.id,status:t.status,title:t.title,jobtype:t.jobtype,maxSizeReached:t.max_size_reached,csvContainsFormulas:t.csv_contains_formulas}}class stream_handler_ReportingNotifierStreamHandler{constructor(t,e){this.notifications=t,this.apiClient=e}showNotifications({completed:t,failed:e}){return a.from((async()=>{const n={toastLifeTimeMs:864e5};for(const e of t)e.csvContainsFormulas?this.notifications.toasts.addWarning(E(e,this.apiClient.getManagementLink,this.apiClient.getDownloadLink),n):e.maxSizeReached?this.notifications.toasts.addWarning(v(e,this.apiClient.getManagementLink,this.apiClient.getDownloadLink),n):this.notifications.toasts.addSuccess(T(e,this.apiClient.getManagementLink,this.apiClient.getDownloadLink),n);for(const t of e){const e=await this.apiClient.getError(t.id);this.notifications.toasts.addDanger(m(e,t,this.apiClient.getManagementLink))}return{completed:t,failed:e}})())}findChangedStatusJobs(t){return a.from(this.apiClient.findForJobIds(t)).pipe(Object(c.map)((e=>{const n=[],i=[],r=[];for(const s of e){const{id:e,status:o}=s;t.includes(e)&&(o===p.JOB_STATUSES.COMPLETED||o===p.JOB_STATUSES.WARNINGS?n.push(y(s)):o===p.JOB_STATUSES.FAILED?i.push(y(s)):r.push(e))}var s;return s=r,sessionStorage.setItem(p.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY,JSON.stringify(s)),{completed:n,failed:i}})),Object(c.catchError)((t=>(this.notifications.toasts.addDanger(j(o.i18n.translate("xpack.reporting.publicNotifier.httpErrorMessage",{defaultMessage:"Could not check Reporting job status!"}),t)),window.console.error(t),a.of({completed:[],failed:[]})))))}}var P=n(18),x=n(25),R=n(11);class get_csv_panel_action_ReportingCsvPanelAction{constructor({core:t,startServices$:e,license$:n,usesUiCapabilities:i,apiClient:r}){s()(this,"isDownloading",void 0),s()(this,"type",""),s()(this,"id",p.CSV_REPORTING_ACTION),s()(this,"licenseHasDownloadCsv",!1),s()(this,"capabilityHasDownloadCsv",!1),s()(this,"notifications",void 0),s()(this,"apiClient",void 0),s()(this,"startServices$",void 0),s()(this,"isCompatible",(async t=>{if(!this.licenseHasDownloadCsv||!this.capabilityHasDownloadCsv)return!1;const{embeddable:e}=t;return e.getInput().viewMode!==u.ViewMode.EDIT&&"search"===e.type})),s()(this,"execute",(async t=>{const{embeddable:e}=t;if(!function(t){return t.type===P.SEARCH_EMBEDDABLE_TYPE}(e)||!await this.isCompatible(t))throw new x.IncompatibleActionError;if(this.isDownloading)return;const n=e.getSavedSearch(),{columns:i,getSearchSource:r}=await this.getSearchSource(n,e),s=this.apiClient.getDecoratedJobParams({searchSource:r(!0),columns:i,title:n.title||"",objectType:"downloadCsv"});this.isDownloading=!0,this.notifications.toasts.addSuccess({title:o.i18n.translate("xpack.reporting.dashboard.csvDownloadStartedTitle",{defaultMessage:"CSV Download Started"}),text:o.i18n.translate("xpack.reporting.dashboard.csvDownloadStartedMessage",{defaultMessage:"Your CSV will download momentarily."}),"data-test-subj":"csvDownloadStarted"}),await this.apiClient.createImmediateReport(s).then((({body:t,response:e})=>{this.isDownloading=!1;const i=`${n.title}.csv`,r=new Blob([t],{type:(null==e?void 0:e.headers.get("content-type"))||void 0});if(window.navigator.msSaveOrOpenBlob)return window.navigator.msSaveOrOpenBlob(r,i);const s=window.document.createElement("a"),o=window.URL.createObjectURL(r);s.href=o,s.download=i,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(o),document.body.removeChild(s)})).catch(this.onGenerationFail.bind(this))})),this.isDownloading=!1,this.notifications=t.notifications,this.apiClient=r,this.startServices$=e,n.subscribe((t=>{const e=t.check("reporting","basic"),{showLinks:n}=Object(R.a)(e);this.licenseHasDownloadCsv=n})),i?this.startServices$.subscribe((([{application:t}])=>{var e;this.capabilityHasDownloadCsv=!0===(null===(e=t.capabilities.dashboard)||void 0===e?void 0:e.downloadCsv)})):this.capabilityHasDownloadCsv=!0}getIconType(){return"document"}getDisplayName(){return o.i18n.translate("xpack.reporting.dashboard.downloadCsvPanelTitle",{defaultMessage:"Download CSV"})}async getSearchSource(t,e){const[{uiSettings:n},{data:i}]=await this.startServices$.pipe(Object(c.first)()).toPromise(),{getSharingData:r}=await Object(P.loadSharingDataHelpers)();return await r(t.searchSource,t,{uiSettings:n,data:i})}onGenerationFail(t){this.isDownloading=!1,this.notifications.toasts.addDanger({title:o.i18n.translate("xpack.reporting.dashboard.failedCsvDownloadTitle",{defaultMessage:"CSV download failed"}),text:o.i18n.translate("xpack.reporting.dashboard.failedCsvDownloadMessage",{defaultMessage:"We couldn't generate your CSV at this time."}),"data-test-subj":"downloadCsvFail"})}}var C=n(15),I=n.n(C);const w=t=>Object(_.jsx)(b.Fragment,null,Object(_.jsx)(g.EuiSpacer,null),Object(_.jsx)(g.EuiFlexGroup,{justifyContent:"spaceAround"},Object(_.jsx)(g.EuiFlexItem,{grow:!1},Object(_.jsx)(g.EuiLoadingSpinner,{size:"l"}))),Object(_.jsx)(g.EuiSpacer,null)),M=Object(b.lazy)((()=>Promise.all([n.e(0),n.e(4)]).then(n.bind(null,42)).then((({ScreenCapturePanelContent:t})=>({default:t}))))),A=t=>Object(_.jsx)(b.Suspense,{fallback:Object(_.jsx)(w,null)},Object(_.jsx)(M,t));function k(t,e){return{ReportingPanelPDF:n=>Object(_.jsx)(A,I()({layoutOption:n.layoutOption,requiresSavedState:!1,reportType:p.PDF_REPORT_TYPE,apiClient:e,toasts:t.notifications.toasts,uiSettings:t.uiSettings},n)),ReportingPanelPDFV2:n=>Object(_.jsx)(A,I()({layoutOption:n.layoutOption,requiresSavedState:!1,reportType:p.PDF_REPORT_TYPE_V2,apiClient:e,toasts:t.notifications.toasts,uiSettings:t.uiSettings},n)),ReportingPanelPNGV2:n=>Object(_.jsx)(A,I()({layoutOption:n.layoutOption,requiresSavedState:!1,reportType:p.PNG_REPORT_TYPE_V2,apiClient:e,toasts:t.notifications.toasts,uiSettings:t.uiSettings},n))}}const N=Object(b.lazy)((()=>n.e(0).then(n.bind(null,41)).then((({ReportingPanelContent:t})=>({default:t}))))),D=t=>Object(_.jsx)(b.Suspense,{fallback:Object(_.jsx)(w,null)},Object(_.jsx)(N,t)),L=(t,e,n)=>()=>{const{objectType:i,sharingData:{title:r,layout:s,locatorParams:o}}=e,a={objectType:i,layout:s,title:r};if("printablePdfV2"===n)return{...a,locatorParams:[o]};if("pngV2"===n)return{...a,locatorParams:o};const c=e.shareableUrl.replace(window.location.origin+t.getServerBasePath(),"");return"printablePdf"===n?{...a,relativeUrls:[c]}:{...a,relativeUrl:c}};class plugin_ReportingPublicPlugin{constructor(t){s()(this,"kibanaVersion",void 0),s()(this,"apiClient",void 0),s()(this,"stop$",new a.ReplaySubject(1)),s()(this,"title",o.i18n.translate("xpack.reporting.management.reportingTitle",{defaultMessage:"Reporting"})),s()(this,"breadcrumbText",o.i18n.translate("xpack.reporting.breadcrumb",{defaultMessage:"Reporting"})),s()(this,"config",void 0),s()(this,"contract",void 0),this.config=t.config.get(),this.kibanaVersion=t.env.packageInfo.version}getApiClient(t,e){return this.apiClient||(this.apiClient=new i.b(t,e,this.kibanaVersion)),this.apiClient}getContract(t){if(t&&(this.contract={usesUiCapabilities:()=>{var t;return!1===(null===(t=this.config.roles)||void 0===t?void 0:t.enabled)},components:k(t,this.getApiClient(t.http,t.uiSettings))}),!this.contract)throw new Error("Setup error in Reporting plugin!");return this.contract}setup(t,e){const{getStartServices:i,uiSettings:r}=t,{home:s,management:c,licensing:{license$:d},share:g,uiActions:h}=e,b=a.from(i()),f=!this.config.roles.enabled,m=this.getApiClient(t.http,t.uiSettings);s.featureCatalogue.register({id:"reporting",title:o.i18n.translate("xpack.reporting.registerFeature.reportingTitle",{defaultMessage:"Reporting"}),description:o.i18n.translate("xpack.reporting.registerFeature.reportingDescription",{defaultMessage:"Manage your reports generated from Discover, Visualize, and Dashboard."}),icon:"reportingApp",path:"/app/management/insightsAndAlerting/reporting",showOnHomePage:!1,category:l.FeatureCatalogueCategory.ADMIN}),c.sections.section.insightsAndAlerting.registerApp({id:"reporting",title:this.title,order:1,mount:async e=>{if(e.history.location.pathname.startsWith("/r")){const{mountRedirectApp:t}=await n.e(3).then(n.bind(null,44));return t({...e,share:g,apiClient:m})}e.setBreadcrumbs([{text:this.breadcrumbText}]);const[[r],{mountManagementSection:s}]=await Promise.all([i(),n.e(2).then(n.bind(null,43))]),{chrome:{docTitle:o}}=r;o.change(this.title);const a=await s(t,r,d,this.config.poll,m,g.url,e);return()=>{o.reset(),a()}}}),h.addTriggerAction(u.CONTEXT_MENU_TRIGGER,new get_csv_panel_action_ReportingCsvPanelAction({core:t,apiClient:m,startServices$:b,license$:d,usesUiCapabilities:f}));const j=this.getContract(t),{toasts:O}=t.notifications;return g.register((({apiClient:t,toasts:e,uiSettings:n,license$:i,startServices$:r,usesUiCapabilities:s})=>{let a="",c=!1,u=!0,l=!1;return i.subscribe((t=>{const e=Object(R.a)(t.check("reporting","basic"));a=e.message,c=e.showLinks,u=!e.enableLinks})),s?r.subscribe((([{application:t}])=>{var e;l=!0===(null===(e=t.capabilities.discover)||void 0===e?void 0:e.generateCsv)})):l=!0,{id:"csvReports",getShareMenuItems:({objectType:i,objectId:r,sharingData:s,onClose:d})=>{if("search"!==i)return[];const g=s.getSearchSource,h={title:s.title,objectType:i,columns:s.columns},b=t=>({...h,searchSource:g(!t)}),f=[];if(c&&l){const i=o.i18n.translate("xpack.reporting.shareContextMenu.csvReportsButtonLabel",{defaultMessage:"CSV Reports"});f.push({shareMenuItem:{name:i,icon:"document",toolTipContent:a,disabled:u,"data-test-subj":"csvReportMenuItem",sortOrder:1},panel:{id:"csvReportingPanel",title:i,content:Object(_.jsx)(D,{requiresSavedState:!1,apiClient:t,toasts:e,uiSettings:n,reportType:p.CSV_JOB_TYPE,layoutId:void 0,objectId:r,getJobParams:b,onClose:d})}})}return f}}})({apiClient:m,toasts:O,license$:d,startServices$:b,uiSettings:r,usesUiCapabilities:f})),g.register((({apiClient:t,toasts:e,uiSettings:n,license$:i,startServices$:r,usesUiCapabilities:s})=>{let a="",c=!0,u=!1,l=!1,p=!1;return i.subscribe((t=>{const{enableLinks:e,showLinks:n,message:i}=Object(R.a)(t.check("reporting","gold"));a=i,u=n,c=!e})),s?r.subscribe((([{application:t}])=>{var e,n;l=!0===(null===(e=t.capabilities.dashboard)||void 0===e?void 0:e.generateScreenshot),p=!0===(null===(n=t.capabilities.visualize)||void 0===n?void 0:n.generateScreenshot)})):(l=!0,p=!0),{id:"screenCaptureReports",getShareMenuItems:({objectType:i,objectId:r,isDirty:s,onClose:d,shareableUrl:g,...h})=>{if(!u)return[];if(!["dashboard","visualization"].includes(i))return[];if("dashboard"===i&&!l)return[];if("visualize"===i&&!p)return[];const{sharingData:b}=h,f=[],m=o.i18n.translate("xpack.reporting.shareContextMenu.pngReportsButtonLabel",{defaultMessage:"PNG Reports"}),j={shareableUrl:g,objectType:i,sharingData:b},O=(({sharingData:t})=>null!=t.locatorParams)(j),S=!O,T=O?"pngV2":"png",E={shareMenuItem:{name:m,icon:"document",toolTipContent:a,disabled:c,"data-test-subj":"pngReportMenuItem",sortOrder:10},panel:{id:"reportingPngPanel",title:m,content:Object(_.jsx)(A,{apiClient:t,toasts:e,uiSettings:n,reportType:T,objectId:r,requiresSavedState:S,getJobParams:L(t,j,T),isDirty:s,onClose:d})}},v=o.i18n.translate("xpack.reporting.shareContextMenu.pdfReportsButtonLabel",{defaultMessage:"PDF Reports"}),y=O?"printablePdfV2":"printablePdf",P={shareMenuItem:{name:v,icon:"document",toolTipContent:a,disabled:c,"data-test-subj":"pdfReportMenuItem",sortOrder:10},panel:{id:"reportingPdfPanel",title:v,content:Object(_.jsx)(A,{apiClient:t,toasts:e,uiSettings:n,reportType:y,objectId:r,requiresSavedState:S,layoutOption:"dashboard"===i?"print":void 0,getJobParams:L(t,j,y),isDirty:s,onClose:d})}};return f.push(E),f.push(P),f}}})({apiClient:m,toasts:O,license$:d,startServices$:b,uiSettings:r,usesUiCapabilities:f})),j}start(t){const{notifications:e}=t,n=this.getApiClient(t.http,t.uiSettings),i=new stream_handler_ReportingNotifierStreamHandler(e,n),r=Object(d.a)(this.config.poll.jobsRefresh.interval);return a.timer(0,r).pipe(Object(c.takeUntil)(this.stop$),Object(c.map)((()=>function(){const t=sessionStorage.getItem(p.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY);return t?JSON.parse(t):[]}())),Object(c.filter)((t=>t.length>0)),Object(c.mergeMap)((t=>i.findChangedStatusJobs(t))),Object(c.mergeMap)((({completed:t,failed:e})=>i.showNotifications({completed:t,failed:e}))),Object(c.catchError)((t=>function(t,e){return t.toasts.addDanger(j(o.i18n.translate("xpack.reporting.publicNotifier.pollingErrorMessage",{defaultMessage:"Reporting notifier error!"}),e)),window.console.error(e),a.of({completed:[],failed:[]})}(e,t)))).subscribe(),this.getContract()}stop(){this.stop$.next()}}function F(t){return new plugin_ReportingPublicPlugin(t)}},function(t,e){t.exports=__kbnSharedDeps__.ReactDom}]);