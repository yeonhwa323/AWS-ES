!function(e){function t(t){for(var a,s,r=t[0],n=t[1],o=0,d=[];o<r.length;o++)s=r[o],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);for(c&&c(t);d.length;)d.shift()()}var a={},i={0:0};function s(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(e){var t=[],a=i[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,s){a=i[e]=[t,s]}));t.push(a[2]=r);var n,o=document.createElement("script");o.charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.src=function(e){return s.p+"visualizations.chunk."+e+".js"}(e);var c=new Error;n=function(t){o.onerror=o.onload=null,clearTimeout(d);var a=i[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",c.name="ChunkLoadError",c.type=s,c.request=r,a[1](c)}i[e]=void 0}};var d=setTimeout((function(){n({type:"timeout",target:o})}),12e4);o.onerror=o.onload=n,document.head.appendChild(o)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var r=window.visualizations_bundle_jsonpfunction=window.visualizations_bundle_jsonpfunction||[],n=r.push.bind(r);r.push=t,r=r.slice();for(var o=0;o<r.length;o++)t(r[o]);var c=n;s(s.s=30)}([function(e,t,a){e.exports=a(32)(1075)},function(e,t,a){"use strict";a.d(t,"m",(function(){return s})),a.d(t,"E",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"r",(function(){return o})),a.d(t,"g",(function(){return c})),a.d(t,"w",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"q",(function(){return l})),a.d(t,"e",(function(){return p})),a.d(t,"u",(function(){return v})),a.d(t,"h",(function(){return g})),a.d(t,"y",(function(){return m})),a.d(t,"l",(function(){return f})),a.d(t,"D",(function(){return h})),a.d(t,"d",(function(){return b})),a.d(t,"t",(function(){return S})),a.d(t,"k",(function(){return y})),a.d(t,"C",(function(){return O})),a.d(t,"i",(function(){return j})),a.d(t,"A",(function(){return _})),a.d(t,"o",(function(){return x})),a.d(t,"G",(function(){return w})),a.d(t,"f",(function(){return E})),a.d(t,"v",(function(){return T})),a.d(t,"n",(function(){return A})),a.d(t,"F",(function(){return z})),a.d(t,"z",(function(){return N})),a.d(t,"a",(function(){return I})),a.d(t,"p",(function(){return D})),a.d(t,"x",(function(){return C})),a.d(t,"s",(function(){return k})),a.d(t,"j",(function(){return R})),a.d(t,"B",(function(){return M}));var i=a(3);const[s,r]=Object(i.createGetterSetter)("UISettings"),[n,o]=Object(i.createGetterSetter)("Capabilities"),[c,d]=Object(i.createGetterSetter)("Http"),[u,l]=Object(i.createGetterSetter)("Application"),[p,v]=Object(i.createGetterSetter)("Embeddable"),[g,m]=Object(i.createGetterSetter)("SavedObjects"),[f,h]=Object(i.createGetterSetter)("Types"),[b,S]=Object(i.createGetterSetter)("DocLinks"),[y,O]=Object(i.createGetterSetter)("TimeFilter"),[j,_]=Object(i.createGetterSetter)("Search"),[x,w]=Object(i.createGetterSetter)("UsageCollection",!1),[E,T]=Object(i.createGetterSetter)("Expressions"),[A,z]=Object(i.createGetterSetter)("UiActions"),[P,N]=Object(i.createGetterSetter)("SavedVisualisationsLoader"),[I,D]=Object(i.createGetterSetter)("AggConfigs"),[V,C]=Object(i.createGetterSetter)("Overlays"),[L,k]=Object(i.createGetterSetter)("Chrome"),[R,M]=Object(i.createGetterSetter)("Spaces",!1)},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"g",(function(){return v})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"e",(function(){return h})),a.d(t,"f",(function(){return b}));var i=a(5),s=a.n(i),r=a(3),n=a(6),o=a(13),c=a(16),d=a(8);const u="visualization",l=e=>({title:"",visState:e.type?{type:e.type}:null,uiStateJSON:"{}",description:"",savedSearchId:e.savedSearchId,version:1});function p(e){return`/app/visualize#/edit/${e}`}function v(e){return`#/edit/${encodeURIComponent(e)}`}const g=e=>{const{id:t,title:a,description:i,visState:s,uiStateJSON:r,searchSourceFields:n}=e,o=n&&n.index?s.aggs||[]:s.aggs;return{id:t,title:a,type:s.type,description:i,params:s.params,uiState:JSON.parse(r||"{}"),data:{aggs:o,searchSource:n,savedSearchId:e.savedSearchId}}},m=e=>({id:e.id,title:e.title,description:e.description,visState:{title:e.title,type:e.type,aggs:e.data.aggs,params:e.params},uiStateJSON:JSON.stringify(e.uiState),searchSourceFields:e.data.searchSource,savedSearchId:e.data.savedSearchId});async function f(e,t,a,i,r){const n=t.getAliases().map((e=>{var t;return null===(t=e.appExtensions)||void 0===t?void 0:t.visualizations})).filter(Boolean),o=n.reduce(((e,t)=>t.docTypes.reduce(((a,i)=>(e[i]=t,e)),e)),{}),c=(e,...t)=>s()(n).map(e).concat(t).compact().flatten().uniq().value(),d={type:c("docTypes","visualization"),searchFields:c("searchFields","title^3","description"),search:a?`${a}*`:void 0,perPage:i,page:1,defaultSearchOperator:"AND",hasReference:r},{total:u,savedObjects:l}=await e.find(d);return{total:u,hits:l.map((e=>{const a=o[e.type];return a?{...a.toListItem(e),references:e.references}:function(e,{attributes:t,id:a,references:i}){var s,r,n;const o={id:a,references:i,url:v(a),...t};let c=t.typeName;if(t.visState)try{c=JSON.parse(String(t.visState)).type}catch(e){}return c&&e.get(c)?(o.type=e.get(c),o.savedObjectType="visualization",o.icon=null===(s=o.type)||void 0===s?void 0:s.icon,o.image=null===(r=o.type)||void 0===r?void 0:r.image,o.typeTitle=null===(n=o.type)||void 0===n?void 0:n.title,o.editUrl=`/edit/${a}`,o):(o.error="Unknown visualization type",o)}(t,e)}))}}async function h(e,t){var a;"object"!=typeof t&&(t={id:t});const i=t.id||"",o={id:i,migrationVersion:t.migrationVersion,displayName:u,getEsType:()=>u,getDisplayName:()=>u,searchSource:t.searchSource?e.search.searchSource.createEmpty():void 0},p=l(t);if(!i)return Object.assign(o,p),o;const{saved_object:v,outcome:g,alias_target_id:m}=await e.savedObjectsClient.resolve(u,i);if(!v._version)throw new r.SavedObjectNotFound(u,i||"");const f=s.a.cloneDeep(v.attributes);f.visState&&"string"==typeof f.visState&&(f.visState=JSON.parse(f.visState)),s.a.defaults(f,p),Object.assign(o,f),o.lastSavedTitle=o.title,o.sharingSavedObjectProps={aliasTargetId:m,outcome:g,errorJSON:"conflict"===g&&e.spaces?JSON.stringify({targetType:u,sourceId:i,targetSpace:(await e.spaces.getActiveSpace()).id}):void 0};const h=f.kibanaSavedObjectMeta||{};if(h.searchSourceJSON)try{let a=Object(n.parseSearchSourceJSON)(h.searchSourceJSON);t.searchSource?(a=Object(n.injectSearchSourceReferences)(a,v.references),o.searchSource=await e.search.searchSource.create(a)):o.searchSourceFields=a}catch(e){throw e}return v.references&&v.references.length>0&&Object(d.e)(o,v.references),e.savedObjectsTagging&&(o.tags=e.savedObjectsTagging.ui.getTagIdsFromReferences(v.references)),o.visState=await Object(c.a)(o.visState),null!==(a=o.searchSourceFields)&&void 0!==a&&a.index&&await e.dataViews.get(o.searchSourceFields.index),o}async function b(e,{confirmOverwrite:t=!1,isTitleDuplicateConfirmed:a=!1,onTitleDuplicate:i,copyOnSave:s=!1},r){const c=e.id;s&&delete e.id;const l={visState:JSON.stringify(e.visState),title:e.title,uiStateJSON:e.uiStateJSON,description:e.description,savedSearchId:e.savedSearchId,version:e.version};let p=[];if(e.searchSource){const{searchSourceJSON:t,references:a}=e.searchSource.serialize();l.kibanaSavedObjectMeta={searchSourceJSON:t},p.push(...a)}if(e.searchSourceFields){const[t,a]=Object(n.extractSearchSourceReferences)(e.searchSourceFields),i=JSON.stringify(t);l.kibanaSavedObjectMeta={searchSourceJSON:i},p.push(...a)}r.savedObjectsTagging&&(p=r.savedObjectsTagging.ui.updateTagsReferences(p,e.tags||[]));const v=Object(d.b)({attributes:l,references:p});if(!v.references)throw new Error("References not returned from extractReferences");try{await Object(o.checkForDuplicateTitle)({...e,copyOnSave:s},a,i,r);const n={id:e.id,migrationVersion:e.migrationVersion,references:v.references},c=t?await Object(o.saveWithConfirmation)(l,e,n,r):await r.savedObjectsClient.create(u,v.attributes,{...n,overwrite:!0});return e.id=c.id,e.lastSavedTitle=e.title,e.id}catch(t){return e.id=c,Object(o.isErrorNonFatal)(t)?"":Promise.reject(t)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return u})),a.d(t,"f",(function(){return l})),a.d(t,"b",(function(){return v})),a.d(t,"e",(function(){return g}));var i=a(19);const s=e=>"input_control_vis"===e,r=(e,t,a=[],r="control")=>{var n;s(e)&&(null!==(n=null==t?void 0:t.controls)&&void 0!==n?n:[]).forEach(((e,t)=>{e.indexPattern&&(e.indexPatternRefName=`${r}_${t}_index_pattern`,a.push({name:e.indexPatternRefName,type:i.INDEX_PATTERN_SAVED_OBJECT_TYPE,id:e.indexPattern}),delete e.indexPattern)}))},n=(e,t,a)=>{var i;s(e)&&(null!==(i=t.controls)&&void 0!==i?i:[]).forEach((e=>{if(!e.indexPatternRefName)return;const t=a.find((t=>t.name===e.indexPatternRefName));if(!t)throw new Error(`Could not find index pattern reference "${e.indexPatternRefName}"`);e.indexPattern=t.id,delete e.indexPatternRefName}))},o="_ref_name",c=e=>"metrics"===e,d=(e,t)=>{e(t,"index_pattern"),t.series.forEach((t=>{t.override_index_pattern&&e(t,"series_index_pattern")})),t.annotations&&t.annotations.forEach((t=>{e(t,"index_pattern")}))},u=(e,t,a=[],s="metrics")=>{let r=0;c(e)&&d(((e,t)=>{if(e[t]&&e[t].id){const n=`${s}_${r++}_index_pattern`;e[t+o]=n,a.push({name:n,type:i.INDEX_PATTERN_SAVED_OBJECT_TYPE,id:e[t].id}),delete e[t]}}),t)},l=(e,t,a)=>{c(e)&&d(((e,t)=>{const i=t+o;if(e[i]){const s=a.find((t=>t.name===e[i]));s&&(e[t]={id:s.id}),delete e[i]}}),t)};var p=a(6);function v({attributes:e,references:t=[]}){const a={...e},i=[...t];if(a.searchSourceFields){const[e,t]=Object(p.extractSearchSourceReferences)(a.searchSourceFields);a.searchSourceFields=e,t.forEach((e=>i.push(e)))}if(a.savedSearchId&&(i.push({name:"search_0",type:"search",id:String(a.savedSearchId)}),delete a.savedSearchId,a.savedSearchRefName="search_0"),a.visState){const e=JSON.parse(String(a.visState));e.type&&e.params&&(r(e.type,e.params,i),u(e.type,e.params,i)),a.visState=JSON.stringify(e)}return{references:i,attributes:a}}function g(e,t){var a;if(e.searchSourceFields&&(e.searchSourceFields=Object(p.injectSearchSourceReferences)(e.searchSourceFields,t)),e.savedSearchRefName){const a=t.find((t=>t.name===e.savedSearchRefName));if(!a)throw new Error(`Could not find saved search reference "${e.savedSearchRefName}"`);e.savedSearchId=a.id,delete e.savedSearchRefName}const{type:i,params:s}=null!==(a=e.visState)&&void 0!==a?a:{};i&&s&&(n(i,s,t),l(i,s,t))}},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,a){"use strict";a.r(t),a.d(t,"VISUALIZE_ENABLE_LABS_SETTING",(function(){return i})),a.d(t,"VISUALIZE_EMBEDDABLE_TYPE",(function(){return s}));const i="visualize:enableLabs",s="visualization"},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,a){"use strict";var i=a(11);a.d(t,"a",(function(){return i.VISUALIZE_EMBEDDABLE_TYPE}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(24),s=a(5),r=a.n(s);const n=e=>{if(!e)return e;const t=r.a.cloneDeep(e);return function(e){e.aggs&&e.aggs.forEach((e=>{"terms"===e.type&&e.params&&"_term"===e.params.orderBy&&(e.params.orderBy="_key")}))}(t),function(e){"boolean"==typeof r.a.get(e,"params.showMeticsAtAllLevels")&&(e.params.showMetricsAtAllLevels=e.params.showMeticsAtAllLevels,delete e.params.showMeticsAtAllLevels)}(t),function(e){e.aggs&&e.aggs.forEach((e=>{"date_histogram"===e.type&&e.params&&"auto"!==e.params.interval&&void 0===e.params.scaleMetricValues&&(e.params.scaleMetricValues=!0)}))}(t),e.params&&["line","area","histogram"].includes(e.params.type)&&function(e){if(e.params.seriesParams)return;const t=e.params.setYExtents,a=e.params.defaultYExtents,i=["stacked","overlap"].includes(e.params.mode)?"normal":e.params.mode||"normal";e.params.valueAxes&&e.params.valueAxes.length||(e.params.valueAxes=[{id:"ValueAxis-1",name:"LeftAxis-1",type:"value",position:"left",show:!0,style:{},scale:{type:"linear",mode:"normal"},labels:{show:!0,rotate:0,filter:!1,truncate:100},title:{text:"Count"}}]),e.params.valueAxes[0].scale={...e.params.valueAxes[0].scale,type:e.params.scale||"linear",setYExtents:e.params.setYExtents||!1,defaultYExtents:e.params.defaultYExtents||!1,boundsMargin:a?e.params.boundsMargin:0,min:t?e.params.yAxis.min:void 0,max:t?e.params.yAxis.max:void 0,mode:i};const s=e.params.smoothLines?"cardinal":e.params.interpolate,r=["stacked","percentage","wiggle","silhouette"].includes(e.params.mode);e.params.seriesParams=[{show:!0,type:e.params.type||"line",mode:r?"stacked":"normal",interpolate:s,drawLinesBetweenPoints:e.params.drawLinesBetweenPoints,showCircles:e.params.showCircles,radiusRatio:e.params.radiusRatio,data:{label:"Count",id:"1"},lineWidth:2,valueAxis:"ValueAxis-1"}]}(t),e.params&&"metrics"===e.type&&function(e){e.params.series&&e.params.series.forEach((e=>{const t=e.id,a=e.metrics;isNaN(t)||(e.id=`x${t}`),null==a||a.forEach((e=>{const t=e.id;isNaN(t)||(e.id=`x${t}`)}))}))}(t),"gauge"===e.type&&e.fontSize&&(delete t.fontSize,Object(i.set)(t,"gauge.style.fontSize",e.fontSize)),["gauge","metric"].includes(e.type)&&"Metric"===r.a.get(e.params,"gauge.gaugeType",null)?(t.type="metric",t.params.addLegend=!1,t.params.type="metric",t.params.metric=t.params.gauge,delete t.params.gauge,delete t.params.metric.gaugeType,delete t.params.metric.gaugeStyle,delete t.params.metric.backStyle,delete t.params.metric.scale,delete t.params.metric.type,delete t.params.metric.orientation,delete t.params.metric.verticalSplit,delete t.params.metric.autoExtend,t.params.metric.metricColorMode=t.params.metric.gaugeColorMode,delete t.params.metric.gaugeColorMode):"metric"===e.type&&"Metric"!==r.a.get(e.params,"gauge.gaugeType","Metric")&&(t.type="gauge",t.params.type="gauge"),function(e){const t=void 0!==r.a.get(e,"params.valueAxes[0].labels.overwriteColor");if("heatmap"===e.type&&e.params&&!t){const t=r.a.get(e,"params.valueAxes[0].labels.show",!1),a=r.a.get(e,"params.valueAxes[0].labels.color","#555");Object(i.set)(e,"params.valueAxes[0].labels.overwriteColor",t&&"#555"!==a)}}(t),t}},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,a){"use strict";let i;a.d(t,"a",(function(){return i})),function(e){e.PROMOTED="promoted",e.TOOLS="tools",e.AGGBASED="aggbased"}(i||(i={}))},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(4);const s=()=>({name:"range",help:i.i18n.translate("visualizations.function.range.help",{defaultMessage:"Generates range object"}),type:"range",args:{from:{types:["number"],help:i.i18n.translate("visualizations.function.range.from.help",{defaultMessage:"Start of range"}),required:!0},to:{types:["number"],help:i.i18n.translate("visualizations.function.range.to.help",{defaultMessage:"End of range"}),required:!0}},fn:(e,t)=>({type:"range",from:t.from,to:t.to})})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(4);const s=()=>({name:"visdimension",help:i.i18n.translate("visualizations.function.visDimension.help",{defaultMessage:"Generates visConfig dimension object"}),type:"vis_dimension",inputTypes:["datatable"],args:{accessor:{types:["string","number"],aliases:["_"],help:i.i18n.translate("visualizations.function.visDimension.accessor.help",{defaultMessage:"Column in your dataset to use (either column index or column name)"})},format:{types:["string"],default:"string",help:i.i18n.translate("visualizations.function.visDimension.format.help",{defaultMessage:"Format"})},formatParams:{types:["string"],default:'"{}"',help:i.i18n.translate("visualizations.function.visDimension.formatParams.help",{defaultMessage:"Format params"})}},fn:(e,t)=>{const a="number"==typeof t.accessor?((e,t)=>t.length>e?e:void 0)(t.accessor,e.columns):((e,t)=>t.find((t=>t.id===e)))(t.accessor,e.columns);if(void 0===a)throw new Error(i.i18n.translate("visualizations.function.visDimension.error.accessor",{defaultMessage:"Column name or index provided is invalid"}));return{type:"vis_dimension",accessor:a,format:{id:t.format,params:JSON.parse(t.formatParams)}}}})},function(e,t,a){"use strict";a.r(t),a.d(t,"prepareLogTable",(function(){return r}));const i=(e,t,a)=>"number"==typeof a?a===t:a.id===e.id,s=(e,t,a)=>{for(const r of a){var s;if(null!==(s=r[0])&&void 0!==s&&s.find((a=>i(e,t,a.accessor))))return r[1]}},r=(e,t)=>({...e,columns:e.columns.map(((e,a)=>({...e,meta:{...e.meta,dimensionName:s(e,a,t)}})))})},function(e,t,a){"use strict";a.r(t);var i=a(20);a.d(t,"range",(function(){return i.a}));var s=a(21);a.d(t,"visDimension",(function(){return s.a}))},function(e,t){e.exports=__kbnSharedDeps__.SaferLodashSet},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(28),s=a(6),r=a(9);const n={applyFilter:s.APPLY_FILTER_TRIGGER,brush:r.SELECT_RANGE_TRIGGER,filter:r.VALUE_CLICK_TRIGGER,tableRowContextMenuClick:i.ROW_CLICK_TRIGGER}},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/discover/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t,a){a(31),__kbnBundles__.define("plugin/visualizations/public",a,33),__kbnBundles__.define("plugin/visualizations/common/constants",a,11),__kbnBundles__.define("plugin/visualizations/common/prepare_log_table",a,22),__kbnBundles__.define("plugin/visualizations/common/expression_functions",a,23)},function(e,t,a){a.p=window.__kbnPublicPath__.visualizations},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,a){"use strict";a.r(t),a.d(t,"plugin",(function(){return K})),a.d(t,"TypesService",(function(){return types_service_TypesService})),a.d(t,"VISUALIZE_EMBEDDABLE_TYPE",(function(){return g.a})),a.d(t,"VIS_EVENT_TO_TRIGGER",(function(){return E.a})),a.d(t,"VisualizationContainer",(function(){return Y})),a.d(t,"getVisSchemas",(function(){return Z})),a.d(t,"VisGroups",(function(){return I.a})),a.d(t,"updateOldState",(function(){return F.a})),a.d(t,"VISUALIZE_ENABLE_LABS_SETTING",(function(){return _.VISUALIZE_ENABLE_LABS_SETTING})),a.d(t,"prepareLogTable",(function(){return W.prepareLogTable})),a.d(t,"urlFor",(function(){return O.g})),a.d(t,"getFullPath",(function(){return O.d}));var i=a(0),s=a.n(i),r=a(1),n=a(10),o=a(17),c=a.n(o),d=a(9),u=a(14),l=a(12),p=a(2);function v({title:e}){const t=Object(r.d)().links.management.visualizationSettings;return Object(p.jsx)(u.I18nProvider,null,Object(p.jsx)(l.EuiEmptyPrompt,{titleSize:"xs",title:Object(p.jsx)("h6",null,Object(p.jsx)(u.FormattedMessage,{id:"visualizations.disabledLabVisualizationTitle",defaultMessage:"{title} is a lab visualization.",values:{title:e}})),iconType:"beaker",body:Object(p.jsx)(u.FormattedMessage,{id:"visualizations.disabledLabVisualizationMessage",defaultMessage:"Please turn on lab-mode in the advanced settings to see lab visualizations."}),actions:Object(p.jsx)(l.EuiLink,{target:"_blank",external:!0,href:t},Object(p.jsx)(u.FormattedMessage,{id:"visualizations.disabledLabVisualizationLink",defaultMessage:"Read documentation"}))}))}var g=a(15);class disabled_lab_embeddable_DisabledLabEmbeddable extends d.Embeddable{constructor(e,t){super(t,{title:e}),s()(this,"domNode",void 0),s()(this,"type",g.a),this.title=e}reload(){}render(e){this.title&&(this.domNode=e,c.a.render(Object(p.jsx)(v,{title:this.title}),e))}destroy(){this.domNode&&c.a.unmountComponentAtNode(this.domNode)}}var m=a(4),f=a(27),h=a(6);const b=async(e,t={})=>{await a.e(3).then(a.t.bind(null,82,7));const{Vis:i}=await a.e(4).then(a.bind(null,87)),s=new i(e,t);return await s.setState(t),s},S=Object(n.lazy)((()=>a.e(1).then(a.bind(null,86))));function y({editorParams:e=[],onClose:t,originatingApp:a,outsideVisualizeApp:i,showAggsSelection:s,selectedVisType:o}={}){const d=document.createElement("div");let v=!1;const g=()=>{v||(c.a.unmountComponentAtNode(d),document.body.removeChild(d),t&&t(),v=!0)};document.body.appendChild(d);const m=Object(p.jsx)(u.I18nProvider,null,Object(p.jsx)(n.Suspense,{fallback:Object(p.jsx)(l.EuiPortal,null,Object(p.jsx)(l.EuiProgress,{size:"xs",position:"fixed"}))},Object(p.jsx)(S,{isOpen:!0,onClose:g,originatingApp:a,stateTransfer:Object(r.e)().getStateTransfer(),outsideVisualizeApp:i,editorParams:e,visTypesRegistry:Object(r.l)(),addBasePath:Object(r.g)().basePath.prepend,uiSettings:Object(r.m)(),savedObjects:Object(r.h)(),usageCollection:Object(r.o)(),application:Object(r.b)(),docLinks:Object(r.d)(),showAggsSelection:s,selectedVisType:o})));return c.a.render(m,d),()=>g()}var O=a(7),j=a(8),_=a(11);const x=e=>async(t,i,s,n)=>{try{var o;const c=t.id,d=c?Object(O.g)(c):"#/edit_by_value",u=c?Object(r.g)().basePath.prepend(`/app/visualize${Object(O.g)(c)}`):"";if(!Object(r.m)().get(_.VISUALIZE_ENABLE_LABS_SETTING)&&"experimental"===t.type.stage)return new disabled_lab_embeddable_DisabledLabEmbeddable(t.title,i);let l=[];t.type.getUsedIndexPattern?l=await t.type.getUsedIndexPattern(t.params):t.data.indexPattern&&(l=[t.data.indexPattern]);const p={visualizeSave:Boolean(Object(r.c)().visualize.save),dashboardSave:Boolean(null===(o=Object(r.c)().dashboard)||void 0===o?void 0:o.showWriteControls)};return(async(...e)=>{const[{VisualizeEmbeddable:t}]=await Promise.all([a.e(7).then(a.bind(null,88)),a.e(2).then(a.t.bind(null,83,7))]);return new t(...e)})(Object(r.k)(),{vis:t,indexPatterns:l,editPath:d,editUrl:u,deps:e,capabilities:p},i,s,n)}catch(e){return console.error(e),new d.ErrorEmbeddable(e,i,n)}};var w=a(13);class visualize_embeddable_factory_VisualizeEmbeddableFactory{constructor(e){s()(this,"type",g.a),s()(this,"attributeService",void 0),s()(this,"savedObjectMetaData",{name:m.i18n.translate("visualizations.savedObjectName",{defaultMessage:"Visualization"}),includeFields:["visState"],type:"visualization",getIconForSavedObject:e=>{var t;return(null===(t=Object(r.l)().get(JSON.parse(e.attributes.visState).type))||void 0===t?void 0:t.icon)||"visualizeApp"},getTooltipForSavedObject:e=>{var t;return`${e.attributes.title} (${null===(t=Object(r.l)().get(JSON.parse(e.attributes.visState).type))||void 0===t?void 0:t.title})`},showSavedObject:e=>{const t=JSON.parse(e.attributes.visState).type,a=Object(r.l)().get(t);return!!a&&(!!Object(r.m)().get(_.VISUALIZE_ENABLE_LABS_SETTING)||"experimental"!==a.stage)},getSavedObjectSubType:e=>JSON.parse(e.attributes.visState).type}),this.deps=e}async isEditable(){return Object(r.c)().visualize.save}getDisplayName(){return m.i18n.translate("visualizations.displayName",{defaultMessage:"Visualization"})}async getCurrentAppId(){return await this.deps.start().core.application.currentAppId$.pipe(Object(f.first)()).toPromise()}async getAttributeService(){return this.attributeService||(this.attributeService=await this.deps.start().plugins.embeddable.getAttributeService(this.type,{saveMethod:this.saveMethod.bind(this),checkForDuplicateTitle:this.checkTitle.bind(this)})),this.attributeService}async createFromSavedObject(e,t,a){const i=await this.deps.start();try{var s,r;const o=await Object(O.e)({savedObjectsClient:i.core.savedObjects.client,search:i.plugins.data.search,dataViews:i.plugins.data.dataViews,spaces:i.plugins.spaces,savedObjectsTagging:null===(s=i.plugins.savedObjectsTaggingOss)||void 0===s?void 0:s.getTaggingApi()},e);var n;if("conflict"===(null===(r=o.sharingSavedObjectProps)||void 0===r?void 0:r.outcome))return new d.ErrorEmbeddable(m.i18n.translate("visualizations.embeddable.legacyURLConflict.errorMessage",{defaultMessage:"This visualization has the same URL as a legacy alias. Disable the alias to resolve this error : {json}",values:{json:null===(n=o.sharingSavedObjectProps)||void 0===n?void 0:n.errorJSON}}),t,a);const c=Object(O.b)(o),u=await b(o.visState.type,c);return x(this.deps)(u,t,await this.getAttributeService(),a)}catch(e){return console.error(e),new d.ErrorEmbeddable(e,t,a)}}async create(e,t){if(e.savedVis){const a=e.savedVis,i=await b(a.type,a);return x(this.deps)(i,e,await this.getAttributeService(),t)}y({originatingApp:await this.getCurrentAppId(),outsideVisualizeApp:!0})}async saveMethod(e){try{var t,a;const{title:i,savedVis:s}=e,r=e.vis;if(!s)throw new Error("No Saved Vis");const n={confirmOverwrite:!1,returnToOrigin:!0,isTitleDuplicateConfirmed:!0,copyOnSave:!1};s.title=i,s.description="",s.searchSourceFields=null==r||null===(t=r.data.searchSource)||void 0===t?void 0:t.getSerializedFields();const o=r.serialize(),{params:c,data:d}=o;s.visState={title:i,type:o.type,params:c,aggs:d.aggs},r&&(s.uiStateJSON=null==r?void 0:r.uiState.toString());const{core:u,plugins:l}=await this.deps.start(),p=await Object(O.f)(s,n,{savedObjectsClient:u.savedObjects.client,overlays:u.overlays,savedObjectsTagging:null===(a=l.savedObjectsTaggingOss)||void 0===a?void 0:a.getTaggingApi()});if(!p||""===p)throw new Error(m.i18n.translate("visualizations.savingVisualizationFailed.errorMsg",{defaultMessage:"Saving a visualization failed"}));return u.chrome.recentlyAccessed.add(Object(O.d)(p),s.title,String(p)),{id:p}}catch(e){throw e}}async checkTitle(e){const t=await this.deps.start().core.savedObjects.client,a=await this.deps.start().core.overlays;return Object(w.checkForDuplicateTitle)({title:e.newTitle,copyOnSave:!1,lastSavedTitle:"",getEsType:()=>this.type,getDisplayName:this.getDisplayName||(()=>this.type)},e.isTitleDuplicateConfirmed,e.onTitleDuplicate,{savedObjectsClient:t,overlays:a})}inject(e,t){var a;const i=e,{type:s,params:r}=null!==(a=i.savedVis)&&void 0!==a?a:{};return s&&r&&(Object(j.d)(s,r,t),Object(j.f)(s,r,t)),e}extract(e){var t,a,i;const s=e,r=[];if(null!==(t=s.savedVis)&&void 0!==t&&t.data.searchSource){const[,e]=Object(h.extractSearchSourceReferences)(s.savedVis.data.searchSource);r.push(...e)}null!==(a=s.savedVis)&&void 0!==a&&a.data.savedSearchId&&r.push({name:"search_0",type:"search",id:String(s.savedVis.data.savedSearchId)});const{type:n,params:o}=null!==(i=s.savedVis)&&void 0!==i?i:{};return n&&o&&(Object(j.a)(n,o,r,`control_${s.id}`),Object(j.c)(n,o,r,`metrics_${s.id}`)),{state:e,references:r}}}var E=a(25);let T=[];const A=[],z={get:()=>[...T],add:e=>{if(T.find((t=>t.name===e.name)))throw new Error(`${e.name} already registered`);A.some((t=>t===e.name))||T.push(e)},remove:e=>{T.find((t=>t.name===e))?T=T.filter((t=>t.name!==e)):A.push(e)}};var P=a(5),N=a.n(P),I=a(18);let D,V;D=h.AggGroupNames.Buckets,V=h.AggGroupNames.Metrics;class schemas_Schemas{constructor(e){s()(this,"all",[]),s()(this,D,[]),s()(this,V,[]),N()(e||[]).chain().map((e=>{if(!e.name)throw new Error("all schema must have a unique name");return"split"===e.name&&(e.params=[{name:"row",default:!0}]),Object(P.defaults)(e,{min:0,max:1/0,group:h.AggGroupNames.Buckets,title:e.name,aggFilter:"*",params:[]}),e})).tap((e=>{this.all=e})).groupBy("group").forOwn(((e,t)=>{this[t]=e})).commit()}}const C={showTimePicker:!0,showQueryBar:!0,showFilterBar:!0,showIndexSelection:!0,hierarchicalData:!1};class base_vis_type_BaseVisType{constructor(e){var t,a,i,r,n,o,c,d,u,l;if(s()(this,"name",void 0),s()(this,"title",void 0),s()(this,"description",void 0),s()(this,"note",void 0),s()(this,"getSupportedTriggers",void 0),s()(this,"icon",void 0),s()(this,"image",void 0),s()(this,"stage",void 0),s()(this,"group",void 0),s()(this,"titleInWizard",void 0),s()(this,"options",void 0),s()(this,"visConfig",void 0),s()(this,"editorConfig",void 0),s()(this,"hidden",void 0),s()(this,"requiresSearch",void 0),s()(this,"hierarchicalData",void 0),s()(this,"setup",void 0),s()(this,"getUsedIndexPattern",void 0),s()(this,"inspectorAdapters",void 0),s()(this,"toExpressionAst",void 0),s()(this,"getInfoMessage",void 0),s()(this,"schemas",void 0),!e.icon&&!e.image)throw new Error("vis_type must define its icon or image");this.name=e.name,this.description=null!==(t=e.description)&&void 0!==t?t:"",this.note=null!==(a=e.note)&&void 0!==a?a:"",this.getSupportedTriggers=e.getSupportedTriggers,this.title=e.title,this.icon=e.icon,this.image=e.image,this.visConfig=Object(P.defaultsDeep)({},e.visConfig,{defaults:{}}),this.editorConfig=Object(P.defaultsDeep)({},e.editorConfig,{collections:{}}),this.options=Object(P.defaultsDeep)({},e.options,C),this.stage=null!==(i=e.stage)&&void 0!==i?i:"production",this.group=null!==(r=e.group)&&void 0!==r?r:I.a.AGGBASED,this.titleInWizard=null!==(n=e.titleInWizard)&&void 0!==n?n:"",this.hidden=null!==(o=e.hidden)&&void 0!==o&&o,this.requiresSearch=null!==(c=e.requiresSearch)&&void 0!==c&&c,this.setup=e.setup,this.hierarchicalData=null!==(d=e.hierarchicalData)&&void 0!==d&&d,this.getUsedIndexPattern=e.getUsedIndexPattern,this.inspectorAdapters=e.inspectorAdapters,this.toExpressionAst=e.toExpressionAst,this.getInfoMessage=e.getInfoMessage,this.schemas=new schemas_Schemas(null!==(u=null===(l=this.editorConfig)||void 0===l?void 0:l.schemas)&&void 0!==u?u:[])}}class types_service_TypesService{constructor(){s()(this,"types",{}),s()(this,"unregisteredHiddenTypes",[])}registerVisualization(e){if(this.unregisteredHiddenTypes.includes(e.name)&&(e.hidden=!0),this.types[e.name])throw new Error("type already exists!");this.types[e.name]=e}setup(){return{createBaseVisualization:e=>{const t=new base_vis_type_BaseVisType(e);this.registerVisualization(t)},registerAlias:z.add,hideTypes:e=>{e.forEach((e=>{this.types[e]?this.types[e].hidden=!0:this.unregisteredHiddenTypes.push(e)}))}}}start(){return{get:e=>this.types[e],all:()=>[...Object.values(this.types)],getAliases:z.get,unRegisterAlias:z.remove,getByGroup:e=>Object.values(this.types).filter((t=>t.group===e))}}stop(){}}var L=a(20),k=a(21);const R=()=>({name:"xydimension",help:m.i18n.translate("visualizations.function.xydimension.help",{defaultMessage:"Generates xy dimension object"}),type:"xy_dimension",args:{visDimension:{types:["vis_dimension"],help:m.i18n.translate("visualizations.function.xyDimension.visDimension.help",{defaultMessage:"Dimension object config"}),required:!0},label:{types:["string"],help:m.i18n.translate("visualizations.function.xyDimension.label.help",{defaultMessage:"Label"})},aggType:{types:["string"],help:m.i18n.translate("visualizations.function.xyDimension.aggType.help",{defaultMessage:"Aggregation type"})},params:{types:["string"],default:'"{}"',help:m.i18n.translate("visualizations.function.xyDimension.params.help",{defaultMessage:"Params"})}},fn:(e,t)=>({type:"xy_dimension",label:t.label,aggType:t.aggType,params:JSON.parse(t.params),accessor:t.visDimension.accessor,format:t.visDimension.format})});var M=a(3);var F=a(16),B=a(26);function G(e){const{savedObjectsClient:t,visualizationTypes:a}=e;class SavedObjectLoaderVisualize extends w.SavedObjectLoader{constructor(...e){super(...e),s()(this,"mapHitSource",((e,t,i=[])=>{const s=a;e.id=t,e.references=i,e.url=this.urlFor(t);let r=e.typeName;if(e.visState)try{r=JSON.parse(String(e.visState)).type}catch(e){}return r&&s.get(r)?(e.type=s.get(r),e.savedObjectType="visualization",e.icon=e.type.icon,e.image=e.type.image,e.typeTitle=e.type.title,e.editUrl=`/edit/${t}`,e):(e.error="Unknown visualization type",e)}))}urlFor(e){return`#/edit/${encodeURIComponent(e)}`}findListItems(e="",i=100){const{size:s=100,references:r}="number"==typeof i?{size:i}:i;return async function({visTypes:e,search:t,size:a,savedObjectsClient:i,mapSavedObjectApiHits:s,references:r}){const n=e.map((e=>{var t;return null===(t=e.appExtensions)||void 0===t?void 0:t.visualizations})).filter(Boolean),o=n.reduce(((e,t)=>t.docTypes.reduce(((a,i)=>(e[i]=t,e)),e)),{}),c=(e,...t)=>N()(n).map(e).concat(t).compact().flatten().uniq().value(),d={type:c("docTypes","visualization"),searchFields:c("searchFields","title^3","description"),search:t?`${t}*`:void 0,perPage:a,page:1,defaultSearchOperator:"AND",hasReference:r},{total:u,savedObjects:l}=await i.find(d);return{total:u,hits:l.map((e=>{const t=o[e.type];return t?{...t.toListItem(e),references:e.references}:s(e)}))}}({search:e,size:s,references:r,mapSavedObjectApiHits:this.mapSavedObjectApiHits.bind(this),savedObjectsClient:t,visTypes:a.getAliases()})}}const i=function(e){const t=B.__LEGACY.createSavedSearchesLoader(e);class SavedVis extends e.savedObjects.SavedObjectClass{constructor(a={}){"object"!=typeof a&&(a={id:a});const i=a.type?{type:a.type}:null;super({type:SavedVis.type,mapping:SavedVis.mapping,extractReferences:j.b,injectReferences:j.e,id:a.id||"",indexPattern:a.indexPattern,defaults:{title:"",visState:i,uiStateJSON:"{}",description:"",savedSearchId:a.savedSearchId,version:1},afterESResp:async a=>{var i;const s=a;return s.visState=await Object(F.a)(s.visState),null!==(i=s.searchSourceFields)&&void 0!==i&&i.index&&await e.indexPatterns.get(s.searchSourceFields.index),s.savedSearchId&&await t.get(s.savedSearchId),s}}),this.showInRecentlyAccessed=!0,this.getFullPath=()=>`/app/visualize#/edit/${this.id}`}}return s()(SavedVis,"type","visualization"),s()(SavedVis,"mapping",{title:"text",visState:"json",uiStateJSON:"text",description:"text",savedSearchId:"keyword",version:"integer"}),s()(SavedVis,"fieldOrder",["title","description"]),SavedVis}(e);return new SavedObjectLoaderVisualize(i,t)}class plugin_VisualizationsPlugin{constructor(e){s()(this,"types",new types_service_TypesService),s()(this,"getStartServicesOrDie",void 0)}setup(e,{expressions:t,embeddable:a,usageCollection:i,data:s}){const n=this.getStartServicesOrDie=Object(M.createStartServicesGetter)(e.getStartServices);Object(r.E)(e.uiSettings),Object(r.G)(i),t.registerFunction(L.a),t.registerFunction(k.a),t.registerFunction(R);const o=new visualize_embeddable_factory_VisualizeEmbeddableFactory({start:n});return a.registerEmbeddableFactory(g.a,o),{...this.types.setup()}}start(e,{data:t,expressions:a,uiActions:i,embeddable:s,savedObjects:n,spaces:o,savedObjectsTaggingOss:c}){const d=this.types.start();Object(r.D)(d),Object(r.u)(s),Object(r.q)(e.application),Object(r.r)(e.application.capabilities),Object(r.w)(e.http),Object(r.y)(e.savedObjects),Object(r.t)(e.docLinks),Object(r.A)(t.search),Object(r.v)(a),Object(r.F)(i),Object(r.C)(t.query.timefilter.timefilter),Object(r.p)(t.search.aggs),Object(r.x)(e.overlays),Object(r.s)(e.chrome),o&&Object(r.B)(o);const u=G({savedObjectsClient:e.savedObjects.client,indexPatterns:t.indexPatterns,savedObjects:n,visualizationTypes:d});return Object(r.z)(u),{...d,showNewVisModal:y,getSavedVisualization:async a=>Object(O.e)({search:t.search,savedObjectsClient:e.savedObjects.client,dataViews:t.dataViews,spaces:o,savedObjectsTagging:null==c?void 0:c.getTaggingApi()},a),saveVisualization:async(t,a)=>Object(O.f)(t,a,{savedObjectsClient:e.savedObjects.client,overlays:e.overlays,savedObjectsTagging:null==c?void 0:c.getTaggingApi()}),findListItems:async(t,a,i)=>Object(O.c)(e.savedObjects.client,d,t,a,i),createVis:async(e,t)=>await b(e,t),convertToSerializedVis:O.b,convertFromSerializedVis:O.a,savedVisualizationsLoader:u,__LEGACY:{createVisEmbeddableFromObject:x({start:this.getStartServicesOrDie})}}}stop(){this.types.stop()}}var J=a(29),U=a.n(J);const $=Object(n.lazy)((()=>a.e(6).then(a.bind(null,84)))),q=Object(n.lazy)((()=>a.e(5).then(a.bind(null,85)))),Y=({"data-test-subj":e="",className:t,children:a,handlers:i,showNoResult:s=!1,error:r})=>{const o=U()("visualization",t),c=Object(p.jsx)("div",{className:"visChart__spinner"},Object(p.jsx)(l.EuiLoadingChart,{mono:!0,size:"l"}));return Object(p.jsx)("div",{"data-test-subj":e,className:o},Object(p.jsx)(n.Suspense,{fallback:c},r?Object(p.jsx)(q,{onInit:()=>i.done(),error:r}):s?Object(p.jsx)($,{onInit:()=>i.done()}):a))},{isDateHistogramBucketAggConfig:H}=h.search.aggs,Z=(e,{timeRange:t,timefilter:a})=>{const i=(e,i)=>{if(H(i)){i.params.timeRange=t;const e=i.params.timeRange&&i.fieldIsTimeField()?a.calculateBounds(i.params.timeRange):void 0;i.buckets.setBounds(e),i.buckets.setInterval(i.params.interval)}const s=["derivative","moving_avg","serial_diff","cumulative_sum","sum_bucket","avg_bucket","min_bucket","max_bucket"].includes(i.type.name)?i.params.customMetric||i.aggConfigs.getRequestAggById(i.params.metricAgg):i,r={};"geohash_grid"===i.type.name&&(r.precision=i.params.precision,r.useGeocentroid=i.params.useGeocentroid);const n=i.makeLabel&&i.makeLabel();return{accessor:e,format:s.toSerializedFieldFormat(),params:r,label:n,aggType:i.type.name}};let s=0;const r={metric:[]};if(!e.data.aggs)return r;const n=e.data.aggs.getResponseAggs().filter((e=>e.enabled)),o=e.isHierarchical(),c=n.filter((e=>"metrics"===e.type.type));return n.forEach((t=>{let a=!1,d=t.schema;if(!d){if("geo_centroid"!==t.type.name)return void s++;d="geo_centroid"}"split"===d&&(d="split_"+(e.params.row?"row":"column"),a=n.length-c.length>1),r[d]||(r[d]=[]),o&&"metrics"===t.type.type||r[d].push(i(s++,t)),!o||"metrics"===t.type.type&&c.length!==n.length||c.forEach((e=>{const t=i(s++,e);a||r.metric.push(t)}))})),r};var W=a(22);a(23);function K(e){return new plugin_VisualizationsPlugin(e)}},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,a){a.r(t);var i=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))}]);