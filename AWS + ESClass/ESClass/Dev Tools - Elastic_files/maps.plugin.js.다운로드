/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,i,a=t[0],o=t[1],s=0,u=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"maps.chunk."+e+".js"}(e);var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",c.name="ChunkLoadError",c.type=i,c.request=a,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var a=window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;i(i.s=24)}([function(e,t,n){"use strict";n.d(t,"w",(function(){return i})),n.d(t,"x",(function(){return a})),n.d(t,"y",(function(){return o})),n.d(t,"z",(function(){return s})),n.d(t,"hb",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"R",(function(){return f})),n.d(t,"gb",(function(){return E})),n.d(t,"M",(function(){return b})),n.d(t,"P",(function(){return g})),n.d(t,"G",(function(){return m})),n.d(t,"Q",(function(){return S})),n.d(t,"O",(function(){return O})),n.d(t,"L",(function(){return I})),n.d(t,"h",(function(){return T})),n.d(t,"pb",(function(){return L})),n.d(t,"ob",(function(){return y})),n.d(t,"qb",(function(){return h})),n.d(t,"X",(function(){return A})),n.d(t,"U",(function(){return M})),n.d(t,"W",(function(){return P})),n.d(t,"Z",(function(){return N})),n.d(t,"Y",(function(){return R})),n.d(t,"V",(function(){return D})),n.d(t,"rb",(function(){return C})),n.d(t,"Lb",(function(){return v})),n.d(t,"Kb",(function(){return x})),n.d(t,"db",(function(){return j})),n.d(t,"Ab",(function(){return w})),n.d(t,"F",(function(){return U})),n.d(t,"T",(function(){return k})),n.d(t,"lb",(function(){return F})),n.d(t,"H",(function(){return G})),n.d(t,"xb",(function(){return B})),n.d(t,"zb",(function(){return V})),n.d(t,"yb",(function(){return $})),n.d(t,"wb",(function(){return H})),n.d(t,"Db",(function(){return Y})),n.d(t,"mb",(function(){return z})),n.d(t,"ib",(function(){return J})),n.d(t,"m",(function(){return W})),n.d(t,"Ib",(function(){return q})),n.d(t,"q",(function(){return K})),n.d(t,"p",(function(){return Z})),n.d(t,"o",(function(){return X})),n.d(t,"D",(function(){return Q})),n.d(t,"E",(function(){return ee})),n.d(t,"kb",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"B",(function(){return re})),n.d(t,"C",(function(){return ie})),n.d(t,"K",(function(){return ae})),n.d(t,"tb",(function(){return oe})),n.d(t,"fb",(function(){return se})),n.d(t,"bb",(function(){return ce})),n.d(t,"v",(function(){return ue})),n.d(t,"t",(function(){return le})),n.d(t,"u",(function(){return de})),n.d(t,"a",(function(){return pe})),n.d(t,"b",(function(){return fe})),n.d(t,"ub",(function(){return _e})),n.d(t,"N",(function(){return Ee})),n.d(t,"J",(function(){return be})),n.d(t,"I",(function(){return ge})),n.d(t,"Fb",(function(){return me})),n.d(t,"r",(function(){return Se})),n.d(t,"j",(function(){return Oe})),n.d(t,"k",(function(){return Ie})),n.d(t,"Cb",(function(){return Te})),n.d(t,"cb",(function(){return Le})),n.d(t,"i",(function(){return ye})),n.d(t,"g",(function(){return he})),n.d(t,"sb",(function(){return Ae})),n.d(t,"Eb",(function(){return Me})),n.d(t,"ab",(function(){return Pe})),n.d(t,"n",(function(){return Ne})),n.d(t,"Hb",(function(){return Re})),n.d(t,"vb",(function(){return De})),n.d(t,"nb",(function(){return Ce})),n.d(t,"Bb",(function(){return ve})),n.d(t,"S",(function(){return xe})),n.d(t,"eb",(function(){return je})),n.d(t,"Gb",(function(){return we})),n.d(t,"jb",(function(){return Ue})),n.d(t,"l",(function(){return ke})),n.d(t,"s",(function(){return Fe})),n.d(t,"Jb",(function(){return Ge}));var r=n(1);const i="kibana",a="ems/files",o="fonts",s="ems/tiles",c="map",u="maps",l="gisApp",d="logoKibana",p=r.i18n.translate("xpack.maps.visTypeAlias.title",{defaultMessage:"Maps"}),f="initialLayers",_=`app/${u}`,E="map",b=`api/${u}`,g=`${b}/indexSettings`,m=`${b}/fonts`,S=`${b}/docSource`,O=`/${b}/feature`,I=`/${b}/getMatchingIndexes`,T=`/${b}/checkIsDrawingIndex`,L="mvt/getTile",y="mvt/getGridTile",h="source_layer",A="__kbn_metadata_feature__",M="__kbn_feature_count__",P="__kbn_is_tile_complete__",N="__kbn_vector_shape_type_counts__",R="__kbn_too_many_features_image_id__",D="__kbn_is_centroid_feature__",C="token";function v(e){return`/${_}${x(e)}`}function x(e){return e?`/${E}/${e}`:`/${E}`}let j,w,U;!function(e){e.TILE="TILE",e.VECTOR="VECTOR",e.VECTOR_TILE="VECTOR_TILE",e.HEATMAP="HEATMAP",e.BLENDED_VECTOR="BLENDED_VECTOR",e.TILED_VECTOR="TILED_VECTOR"}(j||(j={})),function(e){e.EMS_TMS="EMS_TMS",e.EMS_FILE="EMS_FILE",e.ES_GEO_GRID="ES_GEO_GRID",e.ES_GEO_LINE="ES_GEO_LINE",e.ES_SEARCH="ES_SEARCH",e.ES_PEW_PEW="ES_PEW_PEW",e.ES_TERM_SOURCE="ES_TERM_SOURCE",e.EMS_XYZ="EMS_XYZ",e.WMS="WMS",e.KIBANA_TILEMAP="KIBANA_TILEMAP",e.REGIONMAP_FILE="REGIONMAP_FILE",e.GEOJSON_FILE="GEOJSON_FILE",e.MVT_SINGLE_LAYER="MVT_SINGLE_LAYER",e.TABLE_SOURCE="TABLE_SOURCE"}(w||(w={})),function(e){e.SOURCE="source",e.JOIN="join"}(U||(U={}));const k="__kbnjoin__",F="meta",G="formatters",B="source",V=`${B}_${F}`,$=`${B}_${G}`,H=`${B}_bounds`,Y="SUPPORTS_FEATURE_EDITING_REQUEST_ID",z=0,J=24,W=5,q=2,K=1e4,Z=100,X=65535,Q="__kbn__feature_id__",ee="__kbn_isvisibleduetojoin__",te="_";let ne;!function(e){e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape"}(ne||(ne={}));const re=["geo_point","geo_shape"];let ie,ae;!function(e){e.INTERSECTS="INTERSECTS",e.DISJOINT="DISJOINT",e.WITHIN="WITHIN"}(ie||(ie={})),function(e){e.POINT="Point",e.MULTI_POINT="MultiPoint",e.LINE_STRING="LineString",e.MULTI_LINE_STRING="MultiLineString",e.POLYGON="Polygon",e.MULTI_POLYGON="MultiPolygon",e.GEOMETRY_COLLECTION="GeometryCollection"}(ae||(ae={}));const oe=0,se=0,ce=1,ue={type:"FeatureCollection",features:[]};let le,de;!function(e){e.DRAW_SHAPES="DRAW_SHAPES",e.DRAW_POINTS="DRAW_POINTS",e.DRAW_FILTERS="DRAW_FILTERS",e.NONE="NONE"}(le||(le={})),function(e){e.BOUNDS="BOUNDS",e.DISTANCE="DISTANCE",e.POLYGON="POLYGON",e.POINT="POINT",e.LINE="LINE",e.SIMPLE_SELECT="SIMPLE_SELECT",e.DELETE="DELETE"}(de||(de={}));const pe="_of_";let fe,_e,Ee;!function(e){e.AVG="avg",e.COUNT="count",e.MAX="max",e.MIN="min",e.SUM="sum",e.TERMS="terms",e.PERCENTILE="percentile",e.UNIQUE_COUNT="cardinality"}(fe||(fe={})),function(e){e.HEATMAP="heatmap",e.POINT="point",e.GRID="grid"}(_e||(_e={})),function(e){e.COARSE="COARSE",e.FINE="FINE",e.MOST_FINE="MOST_FINE",e.SUPER_FINE="SUPER_FINE"}(Ee||(Ee={}));const be="gridSplit",ge="gridCentroid",me="__percentage",Se=50,Oe=r.i18n.translate("xpack.maps.aggs.defaultCountLabel",{defaultMessage:"count"}),Ie="doc_count";let Te,Le,ye;!function(e){e.STATIC="STATIC",e.DYNAMIC="DYNAMIC"}(Te||(Te={})),function(e){e.VECTOR="VECTOR",e.HEATMAP="HEATMAP",e.TILE="TILE"}(Le||(Le={})),function(e){e.CATEGORICAL="CATEGORICAL",e.ORDINAL="ORDINAL"}(ye||(ye={}));const he=["string","ip","boolean"],Ae=["number","date"];let Me,Pe;!function(e){e.CIRCLE="circle",e.ICON="icon"}(Me||(Me={})),function(e){e.NONE="NONE",e.SMALL="SMALL",e.MEDIUM="MEDIUM",e.LARGE="LARGE"}(Pe||(Pe={}));const Ne="marker";let Re,De,Ce;!function(e){e.SYMBOLIZE_AS="symbolizeAs",e.FILL_COLOR="fillColor",e.LINE_COLOR="lineColor",e.LINE_WIDTH="lineWidth",e.ICON="icon",e.ICON_SIZE="iconSize",e.ICON_ORIENTATION="iconOrientation",e.LABEL_TEXT="labelText",e.LABEL_COLOR="labelColor",e.LABEL_SIZE="labelSize",e.LABEL_BORDER_COLOR="labelBorderColor",e.LABEL_BORDER_SIZE="labelBorderSize"}(Re||(Re={})),function(e){e.LIMIT="LIMIT",e.CLUSTERS="CLUSTERS",e.TOP_HITS="TOP_HITS",e.MVT="MVT"}(De||(De={})),function(e){e.STRING="String",e.NUMBER="Number"}(Ce||(Ce={}));const ve="SPATIAL_FILTERS_LAYER_ID";let xe,je,we,Ue,ke;!function(e){e.LAST_SAVED_LOCATION="LAST_SAVED_LOCATION",e.FIXED_LOCATION="FIXED_LOCATION",e.BROWSER_LOCATION="BROWSER_LOCATION",e.AUTO_FIT_TO_BOUNDS="AUTO_FIT_TO_BOUNDS"}(xe||(xe={})),function(e){e.ELASTICSEARCH="ELASTICSEARCH",e.REFERENCE="REFERENCE",e.SOLUTIONS="SOLUTIONS"}(je||(je={})),function(e){e.POINT="POINT",e.LINE="LINE",e.POLYGON="POLYGON"}(we||(we={})),function(e){e.GET="get",e.FEATURE_STATE="feature-state"}(Ue||(Ue={})),function(e){e.INTERPOLATE="INTERPOLATE",e.PERCENTILES="PERCENTILES"}(ke||(ke={}));const Fe=[50,75,90,95,99],Ge="world_countries"},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){e.exports=n(21)(1075)},function(e,t,n){"use strict";let r;n.d(t,"T",(function(){return i})),n.d(t,"v",(function(){return a})),n.d(t,"V",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"q",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"r",(function(){return f})),n.d(t,"l",(function(){return _})),n.d(t,"P",(function(){return E})),n.d(t,"t",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"n",(function(){return m})),n.d(t,"M",(function(){return S})),n.d(t,"N",(function(){return O})),n.d(t,"E",(function(){return I})),n.d(t,"d",(function(){return T})),n.d(t,"x",(function(){return L})),n.d(t,"Q",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return A})),n.d(t,"g",(function(){return M})),n.d(t,"D",(function(){return P})),n.d(t,"O",(function(){return N})),n.d(t,"c",(function(){return R})),n.d(t,"z",(function(){return D})),n.d(t,"e",(function(){return C})),n.d(t,"G",(function(){return v})),n.d(t,"j",(function(){return x})),n.d(t,"y",(function(){return j})),n.d(t,"F",(function(){return w})),n.d(t,"A",(function(){return U})),n.d(t,"H",(function(){return k})),n.d(t,"K",(function(){return F})),n.d(t,"U",(function(){return B})),n.d(t,"w",(function(){return V})),n.d(t,"J",(function(){return $})),n.d(t,"B",(function(){return H})),n.d(t,"S",(function(){return z})),n.d(t,"u",(function(){return J})),n.d(t,"R",(function(){return q})),n.d(t,"i",(function(){return K})),n.d(t,"k",(function(){return Z})),n.d(t,"C",(function(){return X})),n.d(t,"L",(function(){return Q})),n.d(t,"I",(function(){return ee})),n.d(t,"s",(function(){return te})),n.d(t,"b",(function(){return ne}));const i=e=>r=e,a=()=>r;let o,s;function c(e,t){o=e,s=t}const u=()=>s.fileUpload.IndexNameFormComponent,l=()=>s.fileUpload.FileUploadComponent,d=()=>s.data.indexPatterns,p=()=>s.data.autocomplete,f=()=>s.inspector,_=()=>s.fileUpload,E=()=>o.uiSettings,b=()=>E().get("theme:darkMode",!1),g=()=>s.data.ui.IndexPatternSelect,m=()=>o.http,S=()=>s.data.query.timefilter.timefilter,O=()=>o.notifications.toasts,I=()=>o.savedObjects.client,T=()=>o.chrome,L=()=>o.application.capabilities.maps,y=()=>o.application.capabilities.visualize,h=()=>o.docLinks,A=()=>o.overlays,M=()=>s.data,P=()=>s.savedObjects,N=()=>s.uiActions,R=()=>o,D=()=>s.navigation,C=()=>o.i18n,v=()=>s.data.search,x=()=>s.embeddable,j=()=>o.application.navigateToApp,w=()=>s.savedObjectsTagging,U=()=>s.presentationUtil.ContextProvider,k=()=>s.security,F=()=>s.spaces;let G;const B=e=>G=e,V=()=>G,$=()=>V().showMapsInspectorAdapter,H=()=>V().preserveDrawingBuffer;let Y;const z=e=>Y=e,J=()=>Y;let W;const q=e=>{W=e},K=()=>W,Z=()=>J().emsTileLayerId,X=()=>{const e=J();return e.regionmap&&e.regionmap.layers?e.regionmap.layers:[]},Q=()=>{const e=J();return e.tilemap?e.tilemap:{}},ee=()=>s.share,te=()=>s.dashboard.dashboardFeatureFlagConfig.allowByValueEmbeddables;async function ne(){const e=s.charts?await s.charts.palettes.getPalettes():null;if(!e)return null;const t=e.get("default"),n={syncColors:!0};return e=>{const r=[{name:e,rankAtDepth:0,totalSeriesAtDepth:1}],i=t.getCategoricalColor(r,n);return i||"#3d3d3d"}}},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(1),i=n(0);function a(){return r.i18n.translate("xpack.maps.appTitle",{defaultMessage:"Maps"})}function o(){return r.i18n.translate("xpack.maps.embeddableDisplayName",{defaultMessage:"map"})}function s(){return r.i18n.translate("xpack.maps.source.dataSourceLabel",{defaultMessage:"Data source"})}function c(){return r.i18n.translate("xpack.maps.source.urlLabel",{defaultMessage:"Url"})}function u(e){switch(e){case i.C.INTERSECTS:return r.i18n.translate("xpack.maps.common.esSpatialRelation.intersectsLabel",{defaultMessage:"intersects"});case i.C.DISJOINT:return r.i18n.translate("xpack.maps.common.esSpatialRelation.disjointLabel",{defaultMessage:"disjoint"});case i.C.WITHIN:return r.i18n.translate("xpack.maps.common.esSpatialRelation.withinLabel",{defaultMessage:"within"});case i.C.CONTAINS:return r.i18n.translate("xpack.maps.common.esSpatialRelation.containsLabel",{defaultMessage:"contains"});default:return e}}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/mapsEms/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"h",(function(){return E})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return S}));var r=n(0);let i;!function(e){e.GEO_LINE_AGG="GEO_LINE_AGG",e.GEO_SHAPE_AGGS_GEO_TILE="GEO_SHAPE_AGGS_GEO_TILE",e.ON_PREM_EMS="ON_PREM_EMS"}(i||(i={}));const a={[i.GEO_LINE_AGG]:{name:"geo_line aggregation",license:"gold"},[i.GEO_SHAPE_AGGS_GEO_TILE]:{name:"geo_tile aggregation on geo_shape field-type",license:"gold"},[i.ON_PREM_EMS]:{name:"layer from local Elastic Maps Server",license:"enterprise"}};let o,s=!1,c=!1;const u=()=>o,l=()=>s,d=()=>c;let p,f;const _=new Promise((e=>{f=e})),E=async()=>{await _};async function b(e){g(await e.refresh()),p=e,p.license$.subscribe(g),f(void 0)}function g(e){const t=e.check(r.e,"gold");s="valid"===t.state;const n=e.check(r.e,"enterprise");c="valid"===n.state,o=e.uid}function m(e){for(const t of Object.values(i))e.featureUsage.register(a[t].name,a[t].license)}function S(e){p?p.featureUsage.notifyUsage(a[i[e]].name):console.error("May not call notifyLicensedFeatureUsage before plugin start")}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){var r=n(22),i=n(23);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||i(o)}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));const r=[];function i(e){if(r.some((({type:t})=>e.type===t)))throw new Error(`Unable to register source type ${e.type}. ${e.type} has already been registered`);r.push(e)}function a(e){return r.find((t=>t.type===e))}},function(e,t){e.exports=__kbnSharedDeps__.RisonNode},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));const r=[];function i(e){r.push({checkVisibility:async()=>!0,getIsDisabled:async()=>!1,isBeta:!1,...e})}async function a(){const e=r.map((async e=>({...e,isVisible:await e.checkVisibility(),isDisabled:await e.getIsDisabled()})));return(await Promise.all(e)).filter((({isVisible:e})=>e))}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";function r({attributes:e,references:t=[]}){if(!e.layerListJSON)return{attributes:e,references:t};const n=[],r=JSON.parse(e.layerListJSON);return r.forEach(((e,t)=>{if(e.sourceDescriptor&&"indexPatternId"in e.sourceDescriptor){const r=e.sourceDescriptor,i=`layer_${t}_source_index_pattern`;n.push({name:i,type:"index-pattern",id:r.indexPatternId}),delete r.indexPatternId,r.indexPatternRefName=i}if("joins"in e){const r=e;(r.joins?r.joins:[]).forEach(((e,r)=>{if("indexPatternId"in e.right){const i=e.right,a=`layer_${t}_join_${r}_index_pattern`;n.push({name:a,type:"index-pattern",id:i.indexPatternId}),delete i.indexPatternId,i.indexPatternRefName=a}}))}})),{attributes:{...e,layerListJSON:JSON.stringify(r)},references:t.concat(n)}}function i(e,t){const n=t.find((({name:t})=>t===e));if(!n)throw new Error(`Could not find reference "${e}"`);return n}function a({attributes:e,references:t}){if(!e.layerListJSON)return{attributes:e};const n=JSON.parse(e.layerListJSON);return n.forEach((e=>{if(e.sourceDescriptor&&"indexPatternRefName"in e.sourceDescriptor){const n=e.sourceDescriptor,r=i(n.indexPatternRefName,t);n.indexPatternId=r.id,delete n.indexPatternRefName}if("joins"in e){const n=e;(n.joins?n.joins:[]).forEach((e=>{if("indexPatternRefName"in e.right){const n=e.right,r=i(n.indexPatternRefName,t);n.indexPatternId=r.id,delete n.indexPatternRefName}}))}})),{attributes:{...e,layerListJSON:JSON.stringify(n)}}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/home/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){n(25),__kbnBundles__.define("plugin/maps/public",n,27),__kbnBundles__.define("plugin/maps/common",n,26)},function(e,t,n){n.p=window.__kbnPublicPath__.maps},function(e,t,n){"use strict";n.r(t);var r=n(0);n.d(t,"AGG_TYPE",(function(){return r.b})),n.d(t,"COLOR_MAP_TYPE",(function(){return r.i})),n.d(t,"ES_GEO_FIELD_TYPE",(function(){return r.A})),n.d(t,"FIELD_ORIGIN",(function(){return r.F})),n.d(t,"INITIAL_LOCATION",(function(){return r.S})),n.d(t,"LABEL_BORDER_SIZES",(function(){return r.ab})),n.d(t,"LAYER_TYPE",(function(){return r.db})),n.d(t,"MAP_SAVED_OBJECT_TYPE",(function(){return r.hb})),n.d(t,"SOURCE_TYPES",(function(){return r.Ab})),n.d(t,"STYLE_TYPE",(function(){return r.Cb})),n.d(t,"SYMBOLIZE_AS_TYPES",(function(){return r.Eb}))},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return V})),n.d(t,"MAP_SAVED_OBJECT_TYPE",(function(){return b.hb}));var r=n(2),i=n.n(r),a=n(6),o=n.n(a),s=n(18),c=n(1),u=n(9),l=n(4);const d=()=>Object(l.jsx)(u.EuiDelayRender,null,Object(l.jsx)(u.EuiLoadingContent,{lines:3}));function p({getLazyComponent:e,lazyComponentProps:t}){const n=e();return Object(l.jsx)(u.EuiErrorBoundary,null,Object(l.jsx)(a.Suspense,{fallback:Object(l.jsx)(d,null)},Object(l.jsx)(n,t)))}const f=()=>Object(a.lazy)((()=>n.e(2).then(n.bind(null,299)))),_={title:c.i18n.translate("xpack.maps.inspector.mapDetailsViewTitle",{defaultMessage:"Map details"}),order:30,help:c.i18n.translate("xpack.maps.inspector.mapDetailsViewHelpText",{defaultMessage:"View the map state"}),shouldShow:e=>Boolean(e.map),component:e=>Object(l.jsx)(p,{getLazyComponent:f,lazyComponentProps:e})};var E=n(3),b=n(0),g=n(7),m=n(20);const S={id:b.e,title:Object(g.a)(),subtitle:c.i18n.translate("xpack.maps.featureCatalogue.mapsSubtitle",{defaultMessage:"Plot geographic data."}),description:c.i18n.translate("xpack.maps.feature.appDescription",{defaultMessage:"Explore geospatial data from Elasticsearch and the Elastic Maps Service."}),icon:b.c,path:"/app/maps",showOnHomePage:!1,category:m.FeatureCatalogueCategory.DATA,solutionId:"kibana",order:400};var O=n(5),I=n(13),T=n.n(I),L=n(16),y=n.n(L),h=n(12),A=n(14);let M;async function P(){return void 0!==M||(M=new Promise((async(e,t)=>{try{const{MapEmbeddable:t,getIndexPatternService:r,getMapsCapabilities:i,renderApp:a,createSecurityLayerDescriptors:o,createTileMapLayerDescriptor:s,createRegionMapLayerDescriptor:c,createBasemapLayerDescriptor:u,createESSearchSourceLayerDescriptor:l,suggestEMSTermJoinConfig:d}=await n.e(1).then(n.bind(null,298));e({MapEmbeddable:t,getIndexPatternService:r,getMapsCapabilities:i,renderApp:a,createSecurityLayerDescriptors:o,createTileMapLayerDescriptor:s,createRegionMapLayerDescriptor:c,createBasemapLayerDescriptor:u,createESSearchSourceLayerDescriptor:l,suggestEMSTermJoinConfig:d})}catch(e){t(e)}}))),M}const N="MAPS_APP_LOCATOR";class locators_MapsAppLocatorDefinition{constructor(e){i()(this,"id",N),i()(this,"getLocation",(async e=>{const{mapId:t,filters:n,query:r,refreshInterval:i,timeRange:a,initialLayers:o,hash:s}=e,c=null!=s?s:this.deps.useHash,u={},l={};r&&(u.query=r),n&&n.length&&(u.filters=null==n?void 0:n.filter((e=>!h.esFilters.isFilterPinned(e)))),a&&(l.time=a),n&&n.length&&(l.filters=null==n?void 0:n.filter((e=>h.esFilters.isFilterPinned(e)))),i&&(l.refreshInterval=i);let d=`/map#/${t||""}`;if(d=Object(A.setStateToKbnUrl)("_g",l,{useHash:c},d),d=Object(A.setStateToKbnUrl)("_a",u,{useHash:c},d),o&&o.length){const e=y.a.encode_array(o);d=`${d}&${b.R}=${encodeURIComponent(e)}`}return{app:b.e,path:d,state:{}}})),this.deps=e}}class locators_MapsAppTileMapLocatorDefinition{constructor(e){i()(this,"id","MAPS_APP_TILE_MAP_LOCATOR"),i()(this,"getLocation",(async e=>{const{label:t,mapType:n,colorSchema:r,indexPatternId:i,geoFieldName:a,metricAgg:o,metricFieldName:s,filters:c,query:u,timeRange:l,hash:d=!0}=e,p=[],f=(await P()).createTileMapLayerDescriptor({label:t,mapType:n,colorSchema:r,indexPatternId:i,geoFieldName:a,metricAgg:o,metricFieldName:s});return f&&p.push(f),await this.deps.locator.getLocation({initialLayers:p,filters:c,query:u,timeRange:l,hash:d})})),this.deps=e}}class locators_MapsAppRegionMapLocatorDefinition{constructor(e){i()(this,"id","MAPS_APP_REGION_MAP_LOCATOR"),i()(this,"getLocation",(async e=>{const{label:t,emsLayerId:n,leftFieldName:r,termsFieldName:i,termsSize:a,colorSchema:o,indexPatternId:s,indexPatternTitle:c,metricAgg:u,metricFieldName:l,filters:d,query:p,timeRange:f,hash:_=!0}=e,E=[],b=(await P()).createRegionMapLayerDescriptor({label:t,emsLayerId:n,leftFieldName:r,termsFieldName:i,termsSize:a,colorSchema:o,indexPatternId:s,indexPatternTitle:c,metricAgg:u,metricFieldName:l});return b&&E.push(b),await this.deps.locator.getLocation({initialLayers:E,filters:d,query:p,timeRange:f,hash:_})})),this.deps=e}}const R=Object(O.createAction)({id:O.ACTION_VISUALIZE_GEO_FIELD,type:O.ACTION_VISUALIZE_GEO_FIELD,getDisplayName:()=>c.i18n.translate("xpack.maps.discover.visualizeFieldLabel",{defaultMessage:"Visualize in Maps"}),isCompatible:async()=>!!Object(E.Q)().show,getHref:async e=>{const{app:t,path:n}=await D(e);return Object(E.c)().application.getUrlForApp(t,{path:n,absolute:!1})},execute:async e=>{const{app:t,path:n,state:r}=await D(e);Object(E.c)().application.navigateToApp(t,{path:n,state:r})}}),D=async e=>{var t;const n=await Object(E.q)().get(e.indexPatternId),r=n.fields.find((t=>t.name===e.fieldName)),i=null==r?void 0:r.aggregatable,a=(null==e||null===(t=e.contextualFields)||void 0===t?void 0:t.length)&&"_source"!==(null==e?void 0:e.contextualFields[0]),o=[{id:T()(),visible:!0,type:i?b.db.BLENDED_VECTOR:b.db.VECTOR,sourceDescriptor:{id:T()(),type:b.Ab.ES_SEARCH,tooltipProperties:a?e.contextualFields:[],label:n.title,indexPatternId:e.indexPatternId,geoField:e.fieldName,scalingType:i?b.vb.CLUSTERS:b.vb.LIMIT}}],s=Object(E.I)().url.locators.get(N);return await s.getLocation({filters:Object(E.g)().query.filterManager.getFilters(),query:Object(E.g)().query.queryString.getQuery(),initialLayers:o,timeRange:Object(E.g)().query.timefilter.timefilter.getTime()})};var C=n(11);const v="FILTER_BY_MAP_EXTENT",x=Object(O.createAction)({id:v,type:v,order:20,getDisplayName:({embeddable:e})=>e.getInput().filterByMapExtent?c.i18n.translate("xpack.maps.filterByMapExtentMenuItem.disableDisplayName",{defaultMessage:"Disable filter by map extent"}):c.i18n.translate("xpack.maps.filterByMapExtentMenuItem.enableDisplayName",{defaultMessage:"Enable filter by map extent"}),getIconType:()=>"filter",isCompatible:async({embeddable:e})=>e.type===b.hb&&e.getInput().viewMode===C.ViewMode.EDIT,execute:async({embeddable:e})=>{e.updateInput({filterByMapExtent:!e.getInput().filterByMapExtent})}});var j=n(19);class map_embeddable_factory_MapEmbeddableFactory{constructor(){i()(this,"type",b.hb),i()(this,"savedObjectMetaData",{name:c.i18n.translate("xpack.maps.mapSavedObjectLabel",{defaultMessage:"Map"}),type:b.hb,getIconForSavedObject:()=>b.c}),i()(this,"createFromSavedObject",(async(e,t,n)=>(t.savedObjectId||(t.savedObjectId=e),this.create(t,n)))),i()(this,"create",(async(e,t)=>{const{MapEmbeddable:n}=await P();return new n({editable:await this.isEditable()},e,t)}))}async isEditable(){const{getMapsCapabilities:e}=await P();return e().save}canCreateNew(){return!1}getDisplayName(){return Object(g.d)()}extract(e){const t=e;if(void 0!==t.attributes){const{references:n}=Object(j.a)({attributes:t.attributes});return{state:e,references:n}}return{state:e,references:[]}}}const w={createSecurityLayerDescriptors:async(e,t)=>(await P()).createSecurityLayerDescriptors(e,t),createBasemapLayerDescriptor:async()=>(await P()).createBasemapLayerDescriptor(),createESSearchSourceLayerDescriptor:async e=>(await P()).createESSearchSourceLayerDescriptor(e)};async function U(e){const t=await P();return await t.suggestEMSTermJoinConfig(e)}var k=n(17),F=n(15),G=n(10),B=n(8);class ems_settings_EMSSettings{constructor(e,t){i()(this,"_config",void 0),i()(this,"_getIsEnterprisePlus",void 0),this._config=e,this._getIsEnterprisePlus=t}isEMSUrlSet(){return!!this._config.emsUrl}getEMSRoot(){return this._config.emsUrl.replace(/\/$/,"")}isIncludeElasticMapsService(){return!!this._config.includeElasticMapsService}hasOnPremLicense(){return this._getIsEnterprisePlus()}isEMSEnabled(){return this.isEMSUrlSet()?this._getIsEnterprisePlus():this.isIncludeElasticMapsService()}getEMSFileApiUrl(){return this._config.emsFileApiUrl===B.DEFAULT_EMS_FILE_API_URL&&this.isEMSUrlSet()?`${this.getEMSRoot()}/file`:this._config.emsFileApiUrl}isProxyElasticMapsServiceInMaps(){return!!this._config.proxyElasticMapsServiceInMaps}getEMSTileApiUrl(){return this._config.emsTileApiUrl===B.DEFAULT_EMS_TILE_API_URL&&this.isEMSUrlSet()?`${this.getEMSRoot()}/tile`:this._config.emsTileApiUrl}getEMSLandingPageUrl(){return this._config.emsLandingPageUrl===B.DEFAULT_EMS_LANDING_PAGE_URL&&this.isEMSUrlSet()?`${this.getEMSRoot()}/maps`:this._config.emsLandingPageUrl}getEMSFontLibraryUrl(){return this._config.emsFontLibraryUrl===B.DEFAULT_EMS_FONT_LIBRARY_URL&&this.isEMSUrlSet()?`${this.getEMSRoot()}/tile/fonts/{fontstack}/{range}.pbf`:this._config.emsFontLibraryUrl}}class plugin_MapsPlugin{constructor(e){i()(this,"_initializerContext",void 0),this._initializerContext=e}setup(e,t){Object(G.f)(t.licensing);const n=this._initializerContext.config.get();Object(E.S)(t.mapsEms.config),Object(E.U)(n),Object(E.T)(this._initializerContext.env.packageInfo.version);const r=new ems_settings_EMSSettings(t.mapsEms.config,G.b);Object(E.R)(r);const i=t.share.url.locators.create(new locators_MapsAppLocatorDefinition({useHash:e.uiSettings.get("state:storeInSessionStorage")}));return t.share.url.locators.create(new locators_MapsAppTileMapLocatorDefinition({locator:i})),t.share.url.locators.create(new locators_MapsAppRegionMapLocatorDefinition({locator:i})),t.inspector.registerView(_),t.home&&t.home.featureCatalogue.register(S),t.visualizations.registerAlias(function(e,t){t||e.hideTypes(["region_map","tile_map"]);const n=c.i18n.translate("xpack.maps.visTypeAlias.description",{defaultMessage:"Create and style maps with multiple layers and indices."});return{aliasApp:b.e,aliasPath:`/${b.gb}`,name:b.e,title:b.f,description:n,icon:b.c,stage:"production",appExtensions:{visualizations:{docTypes:[b.hb],searchFields:["title^3"],toListItem(e){const{id:t,type:n,attributes:r}=e,{title:i,description:a}=r;return{id:t,title:i,description:a,editUrl:Object(b.Kb)(t),editApp:b.e,icon:b.c,stage:"production",savedObjectType:n,typeTitle:b.f}}}}}}(t.visualizations,n.showMapVisualizationTypes)),t.embeddable.registerEmbeddableFactory(b.hb,new map_embeddable_factory_MapEmbeddableFactory),e.application.register({id:b.e,title:Object(g.a)(),order:4e3,icon:`plugins/${b.e}/icon.svg`,euiIconType:b.d,category:s.DEFAULT_APP_CATEGORIES.kibana,async mount(e){var n,r;const i=null!==(n=null===(r=t.usageCollection)||void 0===r?void 0:r.components.ApplicationUsageTrackingProvider)&&void 0!==n?n:o.a.Fragment,{renderApp:a}=await P();return a(e,i)}}),{registerLayerWizard:k.b,registerSource:F.b}}start(e,t){return Object(G.g)(t.licensing),Object(E.V)(e,t),e.application.capabilities.maps.show&&t.uiActions.addTriggerAction(O.VISUALIZE_GEO_FIELD_TRIGGER,R),t.uiActions.addTriggerAction(C.CONTEXT_MENU_TRIGGER,x),e.application.capabilities.maps.save||t.visualizations.unRegisterAlias(b.e),{createLayerDescriptors:w,suggestEMSTermJoinConfig:U}}}const V=e=>new plugin_MapsPlugin(e)},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.ElasticEuiLibServices},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/inspector/common/adapters/request");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.SaferLodashSet},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/usageCollection/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.Theme},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/presentationUtil/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}]);